
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data analyzes II - data visualization and analyses &#8212; Winter - 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'analyses/intro_data_analyzes_visualization_II';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python module showcases" href="../showcases/module_showcases.html" />
    <link rel="prev" title="Data analyzes I - basics in data handling" href="intro_data_analyzes_visualization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/pfp_logo.png" class="logo__image only-light" alt="Winter - 2024 - Home"/>
    <img src="../_static/pfp_logo.png" class="logo__image only-dark pst-js-only" alt="Winter - 2024 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../dei.html">Diversity, Equity and Inclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Course overview &amp; procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup for the course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outline.html">General outline</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/introduction.html">Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/introduction_1.html">Introduction I</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../introduction/introduction_2.html">Introduction II</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/intro_jupyter.html">Introduction II - the jupyter ecosystem &amp; notebooks, first look at programming in Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/intro_jupyter_II.html">Introduction II - Jupiter Notebook 7.0</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../introduction/introduction_4.html">Introduction III</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/intro_python_I.html">Introduction III - Introduction to Python - I</a></li>
<li class="toctree-l3"><a class="reference internal" href="../homework/PFP_assignment_2_intro_python_1_2024.html">Homework assignment #2</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../introduction/introduction_5.html">Introduction IV</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/intro_python_II.html">Introduction V - Introduction to Python - II</a></li>

<li class="toctree-l3"><a class="reference internal" href="../introduction/PFP_assignment_3_intro_python_2.html">Homework assignment #3</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../introduction/introduction_6.html">Introduction V</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/intro_python_III.html">Introduction VI - Introduction to Python III</a></li>


<li class="toctree-l3"><a class="reference internal" href="../introduction/PFP_assignment_4_intro_python_3.html">Homework assignment #4</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="intro_data_analyzes_visualization.html">Data analyzes I - basics in data handling</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data analyzes II - data visualization and analyses</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../showcases/module_showcases.html">Python module showcases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../showcases/python_numpy.html">Introduction to NumPy</a></li>














<li class="toctree-l2"><a class="reference internal" href="../showcases/python_scipy.html">Introduction to SciPy</a></li>

<li class="toctree-l2"><a class="reference internal" href="../showcases/python_scikit.html">Introduction to scikit-learn &amp; scikit-image</a></li>




<li class="toctree-l2"><a class="reference internal" href="../showcases/python_visualization_for_data.html">Visualization of different data types with python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../showcases/image_manipulation_nibabel.html">Using Python for neuroimaging data - NiBabel</a></li>


<li class="toctree-l2"><a class="reference internal" href="../showcases/image_manipulation_nilearn.html">Using Python for neuroimaging data - Nilearn</a></li>

<li class="toctree-l2"><a class="reference internal" href="../showcases/statistical_analyses_MRI.html">Nilearn GLM: statistical analyses of MRI in Python</a></li>


<li class="toctree-l2"><a class="reference internal" href="../showcases/functional_connectivity.html">Functional connectivity and resting state</a></li>





<li class="toctree-l2"><a class="reference internal" href="../showcases/diffusion_imaging.html">Structural connectivity and diffusion imaging</a></li>








<li class="toctree-l2"><a class="reference internal" href="../showcases/machine_learning_preparation.html">Preparation Machine Learning</a></li>

<li class="toctree-l2"><a class="reference internal" href="../showcases/machine_learning_nilearn.html">MVPA and Searchlight with <code class="docutils literal notranslate"><span class="pre">nilearn</span></code></a></li>


<li class="toctree-l2"><a class="reference internal" href="../showcases/machine_learning_keras.html"><code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>/<code class="docutils literal notranslate"><span class="pre">Keras</span></code></a></li>


<li class="toctree-l2"><a class="reference internal" href="../showcases/Predicting_age_with_machine_learning.html">Machine learning to predict age from rs-fmri</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../AI.html">The use of AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CoC.html">Code of Conduct</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/MarkovYu/Python_For_Psychologists_24/main?urlpath=tree/lecture/analyses/intro_data_analyzes_visualization_II.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MarkovYu/Python_For_Psychologists_24" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MarkovYu/Python_For_Psychologists_24/edit/main/lecture/analyses/intro_data_analyzes_visualization_II.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MarkovYu/Python_For_Psychologists_24/issues/new?title=Issue%20on%20page%20%2Fanalyses/intro_data_analyzes_visualization_II.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/analyses/intro_data_analyzes_visualization_II.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data analyzes II - data visualization and analyses</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#before-we-get-started">Before we get started …</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives 📍</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-why-do-data-science-in-python">Recap - Why do data science in Python?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#widely-used">Widely-used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-what-kind-of-data-do-i-have-and-where-is-it">Recap - What kind of data do I have and where is it</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-what-is-the-goal-of-the-data-analyzes">Recap - What is the goal of the data analyzes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-how-will-the-respective-steps-be-implemented">Recap - how will the respective steps be implemented</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-data-visualization">Basic data visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underlying-principles">Underlying principles</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">matplotlib</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-plots">standard plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-groupby-in-pandas">📊 Introduction to <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-groupby"><strong>Why Use <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-aggregations-with-groupby"><strong>Common Aggregations with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code></strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-workflow"><strong>GroupBy Workflow:</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-groupby-in-pandas">🐼 <strong>Examples of <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas:</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pros">Pros</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cons">Cons</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-interfaces-to-matplotlib">High-level interfaces to matplotlib</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#going-further-with-advanced-plots">Going further with advanced plots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn"><span class="xref myst">Seaborn</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics-in-python">Statistics in python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-analyses">Descriptive analyses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inferential-analyses">Inferential analyses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin">Pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statsmodels">Statsmodels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outro-q-a-visualization-statistics">Outro/Q&amp;A - visualization &amp; statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outro-q-a-working-with-data-in-python">Outro/Q&amp;A - working with data in python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-core-python-data-science-stack">The core Python “data science” stack</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-core-python-for-psychology-stack">The core “Python for psychology” stack</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-analyzes-ii-data-visualization-and-analyses">
<h1>Data analyzes II - data visualization and analyses<a class="headerlink" href="#data-analyzes-ii-data-visualization-and-analyses" title="Link to this heading">#</a></h1>
<p>Edited by <a class="reference external" href="https://www.y-markov.com/">Yury Markov (he/him)</a>
<a class="reference external" href="https://peerherholz.github.io/">Peer Herholz (he/him)</a><br />
Habilitation candidate  - <a class="reference external" href="http://www.fiebachlab.org/">Fiebach Lab</a>, <a class="reference external" href="https://www.psychologie.uni-frankfurt.de/49868684/Abteilungen">Neurocognitive Psychology</a> at <a class="reference external" href="https://www.goethe-university-frankfurt.de/en?locale=en">Goethe-University Frankfurt</a><br />
Research affiliate - <a class="reference external" href="https://neurodatascience.github.io/">NeuroDataScience lab</a> at <a class="reference external" href="https://www.mcgill.ca/neuro/">MNI</a>/<a class="reference external" href="https://www.mcgill.ca/">McGill</a><br />
Member - <a class="reference external" href="https://bids-specification.readthedocs.io/en/stable/">BIDS</a>, <a class="reference external" href="https://www.repronim.org/">ReproNim</a>, <a class="reference external" href="https://brainhack.org/">Brainhack</a>, <a class="reference external" href="https://www.cneuromod.ca/">Neuromod</a>, <a class="reference external" href="https://ohbm-environment.org/">OHBM SEA-SIG</a>, <a class="reference external" href="https://sites.google.com/view/unique-neuro-ai">UNIQUE</a></p>
<p><img align="left" src="https://raw.githubusercontent.com/G0RELLA/gorella_mwn/master/lecture/static/Twitter%20social%20icons%20-%20circle%20-%20blue.png" alt="logo" title="Twitter" width="32" height="20" /> <img align="left" src="https://raw.githubusercontent.com/G0RELLA/gorella_mwn/master/lecture/static/GitHub-Mark-120px-plus.png" alt="logo" title="Github" width="30" height="20" />     &#64;peerherholz</p>
<section id="before-we-get-started">
<h2>Before we get started …<a class="headerlink" href="#before-we-get-started" title="Link to this heading">#</a></h2>
<br>
<ul class="simple">
<li><p>most of what you’ll see within this lecture was prepared by Ross Markello, Michael Notter and Peer Herholz and further adapted for this course by Peer Herholz</p></li>
<li><p>based on Tal Yarkoni’s <a class="reference external" href="https://neurohackademy.org/course/introduction-to-python-2/">“Introduction to Python” lecture at Neurohackademy 2019</a></p></li>
<li><p>based on <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">10 minutes to pandas</a></p></li>
</ul>
</section>
<section id="objectives">
<h2>Objectives 📍<a class="headerlink" href="#objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>learn basic and efficient usage of python for data analyzes &amp; visualization</p>
<ul>
<li><p>working with data:</p>
<ul>
<li><p>reading, working, writing</p></li>
<li><p>preprocessing, filtering, wrangling</p></li>
</ul>
</li>
<li><p>visualizing data:</p>
<ul>
<li><p>basic plots</p></li>
<li><p>advanced &amp; fancy stuff</p></li>
</ul>
</li>
<li><p>analyzing data:</p>
<ul>
<li><p>descriptive stats</p></li>
<li><p>inferential stats</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="recap-why-do-data-science-in-python">
<h2>Recap - Why do data science in Python?<a class="headerlink" href="#recap-why-do-data-science-in-python" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>all the general benefits of the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">language</span></code> (<code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">source</span></code>, fast, etc.)</p>
<ul>
<li><p>Specifically, it’s a <strong>widely used/very flexible</strong>, <strong>high-level</strong>, <strong>general-purpose</strong>, <strong>dynamic</strong> programming language</p></li>
</ul>
</li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">ecosystem</span></code> contains tens of thousands of packages, several are very widely used in data science applications:</p>
<ul>
<li><p>Jupyter: interactive notebooks</p></li>
<li><p>Numpy: numerical computing in Python</p></li>
<li><p>pandas: data structures for Python</p></li>
<li><p>pingouin: statistics in Python</p></li>
<li><p>statsmodels: statistics in Python</p></li>
<li><p>seaborn: data visualization in Python</p></li>
<li><p>plotly: interactive data visualization in Python</p></li>
<li><p>Scipy: scientific Python tools</p></li>
<li><p>Matplotlib: plotting in Python</p></li>
<li><p>scikit-learn: machine learning in Python</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>even more: <code class="docutils literal notranslate"><span class="pre">Python</span></code> has very good (often best-in-class) external packages for almost everything</p></li>
<li><p>Particularly important for data science, which draws on a very broad toolkit</p></li>
<li><p>Package management is easy (conda, pip)</p></li>
<li><p>Examples for further important/central python data science packages :</p>
<ul>
<li><p>Web development: flask, Django</p></li>
<li><p>Database ORMs: SQLAlchemy, Django ORM (w/ adapters for all major DBs)</p></li>
<li><p>Scraping/parsing text/markup: beautifulsoup, scrapy</p></li>
<li><p>Natural language processing (NLP): nltk, gensim, textblob</p></li>
<li><p>Numerical computation and data analysis: numpy, scipy, pandas, xarray</p></li>
<li><p>Machine learning: scikit-learn, Tensorflow, keras</p></li>
<li><p>Image processing: pillow, scikit-image, OpenCV</p></li>
<li><p>Plotting: matplotlib, seaborn, altair, ggplot, Bokeh</p></li>
<li><p>GUI development: pyQT, wxPython</p></li>
<li><p>Testing: py.test</p></li>
</ul>
</li>
</ul>
<section id="widely-used">
<h3>Widely-used<a class="headerlink" href="#widely-used" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Python is the fastest-growing major programming language</p></li>
<li><p>Top 3 overall (with JavaScript, Java)</p></li>
</ul>
<center><img src="https://149351115.v2.pressablecdn.com/wp-content/uploads/2017/09/growth_major_languages-1-1400x1200.png" width="800px" style="margin-bottom: 10px;"></center><p>What we will do in this section of the course is a <em>short</em> introduction to <code class="docutils literal notranslate"><span class="pre">Python</span></code> for <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">analyses</span></code> including basic <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">operations</span></code> like <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">reading</span></code> and <code class="docutils literal notranslate"><span class="pre">wrangling</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">statistics</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code>. The goal is to showcase crucial tools/resources and their underlying working principles to allow further more in-depth exploration and direct application.</p>
<p>It is divided into the following chapters:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#"><span class="xref myst">Getting ready</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Basic data operations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Reading data</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Exploring data</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Data wrangling</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Basic data visualization</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Underlying principles</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">“standard” plots</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Going further with advanced plots</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Statistics in python</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Descriptive analyses</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Inferential analyses</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Interactive data visualization</span></a></p></li>
</ul>
<p>Here’s what we will focus on in the second block:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#"><span class="xref myst">Basic data visualization</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Underlying principles</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">“standard” plots</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Going further with advanced plots</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Statistics in python</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Descriptive analyses</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Inferential analyses</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Interactive data visualization</span></a></p></li>
</ul>
</section>
<section id="recap-what-kind-of-data-do-i-have-and-where-is-it">
<h3>Recap - What kind of data do I have and where is it<a class="headerlink" href="#recap-what-kind-of-data-do-i-have-and-where-is-it" title="Link to this heading">#</a></h3>
<p>The first crucial step is to get a brief idea of the kind of data we have, where it is, etc. to outline the subsequent parts of the workflow (<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">modules</span></code> to use, analyses to conduct, etc.). At this point it’s important to note that <code class="docutils literal notranslate"><span class="pre">Python</span></code> and its <code class="docutils literal notranslate"><span class="pre">modules</span></code> work tremendously well for basically all kinds of data out there, no matter if <code class="docutils literal notranslate"><span class="pre">behavior</span></code>, neuroimaging, etc. . To keep things rather simple, we will keep using the <code class="docutils literal notranslate"><span class="pre">behavioral</span> <span class="pre">dataset</span></code> from last session that contains <code class="docutils literal notranslate"><span class="pre">ratings</span></code> and <code class="docutils literal notranslate"><span class="pre">demographic</span> <span class="pre">information</span></code> from a group of university students (ah, the classics…).</p>
<p>We already accomplished and worked with the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> quite a bit during the last session, including:</p>
<ul class="simple">
<li><p>reading data</p></li>
<li><p>extract data of interest</p></li>
<li><p>convert to different more intelligible structures and forms</p></li>
</ul>
<p>At the end, we had <code class="docutils literal notranslate"><span class="pre">two</span> <span class="pre">dataframes</span></code>, both containing the <code class="docutils literal notranslate"><span class="pre">data</span></code> of all <code class="docutils literal notranslate"><span class="pre">participants</span></code> but in different <code class="docutils literal notranslate"><span class="pre">formats</span></code>. Does anyone remember what <code class="docutils literal notranslate"><span class="pre">formats</span></code> <code class="docutils literal notranslate"><span class="pre">datasets</span></code> commonly have and how they differ?</p>
<p>True that, we initially had a <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> in <code class="docutils literal notranslate"><span class="pre">wide-format</span></code> but then created a reshaped version in <code class="docutils literal notranslate"><span class="pre">long-format</span></code>. For this session, we will continue to explore aspects of <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code> and <code class="docutils literal notranslate"><span class="pre">analyzes</span></code> via this <code class="docutils literal notranslate"><span class="pre">dataframe</span></code>. Thus, let’s <code class="docutils literal notranslate"><span class="pre">move</span></code> to our <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">storage</span></code> and <code class="docutils literal notranslate"><span class="pre">analyses</span> <span class="pre">directory</span></code> and load it accordingly using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
<span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;C:/Users/ika_m/OneDrive - Johann Wolfgang Goethe Universität/Documents/test_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;AG_01_02_stroop_2025-01-23_13h12.02.354.csv&#39;,
 &#39;BF_31_01_stroop_2025-01-23_12h25.25.690.csv&#39;,
 &#39;BF_31_02_stroop_2025-01-23_13h12.43.710.csv&#39;,
 &#39;data_experiment&#39;,
 &#39;FB_09_02_stroop_2025-01-23_13h12.14.223.csv&#39;,
 &#39;FB_09_03_stroop_2025-01-23_13h30.49.889.csv&#39;,
 &#39;FK_24_01_stroop_2025-01-23_12h36.23.128.csv&#39;,
 &#39;JB_22_01_stroop_2025-01-23_12h29.58.313.csv&#39;,
 &#39;JB_22_02_stroop_2025-01-23_13h13.20.521.csv&#39;,
 &#39;JB_22_03_stroop_2025-01-23_13h32.52.317.csv&#39;,
 &#39;XY_16_03_stroop_2025-01-23_13h31.18.706.csv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data_experiment/preprocessing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;AG_01_02clean.csv&#39;, &#39;cleaned_df_group.csv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_experiment/preprocessing/cleaned_df_group.csv&#39;</span><span class="p">)</span>

<span class="n">df_long</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>participant</th>
      <th>session</th>
      <th>date</th>
      <th>expName</th>
      <th>psychopyVersion</th>
      <th>OS</th>
      <th>frameRate</th>
      <th>resp.keys</th>
      <th>resp.corr</th>
      <th>resp.rt</th>
      <th>...</th>
      <th>trials.thisRepN</th>
      <th>trials.thisTrialN</th>
      <th>trials.thisN</th>
      <th>trials.thisIndex</th>
      <th>trials.ran</th>
      <th>text</th>
      <th>letterColor</th>
      <th>corrAns</th>
      <th>congruent</th>
      <th>trial_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AG_01_02</td>
      <td>1</td>
      <td>2025-01-23_13h12.02.354</td>
      <td>stroop</td>
      <td>2023.1.3</td>
      <td>MacIntel</td>
      <td>20.408163</td>
      <td>left</td>
      <td>1.0</td>
      <td>0.635</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>blue</td>
      <td>red</td>
      <td>left</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG_01_02</td>
      <td>1</td>
      <td>2025-01-23_13h12.02.354</td>
      <td>stroop</td>
      <td>2023.1.3</td>
      <td>MacIntel</td>
      <td>20.408163</td>
      <td>down</td>
      <td>1.0</td>
      <td>0.342</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>green</td>
      <td>green</td>
      <td>down</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AG_01_02</td>
      <td>1</td>
      <td>2025-01-23_13h12.02.354</td>
      <td>stroop</td>
      <td>2023.1.3</td>
      <td>MacIntel</td>
      <td>20.408163</td>
      <td>left</td>
      <td>0.0</td>
      <td>0.641</td>
      <td>...</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>red</td>
      <td>green</td>
      <td>down</td>
      <td>0.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG_01_02</td>
      <td>1</td>
      <td>2025-01-23_13h12.02.354</td>
      <td>stroop</td>
      <td>2023.1.3</td>
      <td>MacIntel</td>
      <td>20.408163</td>
      <td>right</td>
      <td>1.0</td>
      <td>1.076</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>green</td>
      <td>blue</td>
      <td>right</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AG_01_02</td>
      <td>1</td>
      <td>2025-01-23_13h12.02.354</td>
      <td>stroop</td>
      <td>2023.1.3</td>
      <td>MacIntel</td>
      <td>20.408163</td>
      <td>right</td>
      <td>1.0</td>
      <td>0.680</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>blue</td>
      <td>blue</td>
      <td>right</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
</section>
<section id="recap-what-is-the-goal-of-the-data-analyzes">
<h3>Recap - What is the goal of the data analyzes<a class="headerlink" href="#recap-what-is-the-goal-of-the-data-analyzes" title="Link to this heading">#</a></h3>
<p>There obviously many different routes we could pursue when it comes to <code class="docutils literal notranslate"><span class="pre">analyzing</span> <span class="pre">data</span></code>. Ideally, we would know that before starting (<code class="docutils literal notranslate"><span class="pre">pre-registration</span></code> much?) but we all know how these things go… For the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> we aimed at the following, with steps in <code class="docutils literal notranslate"><span class="pre">()</span></code> indicating <code class="docutils literal notranslate"><span class="pre">operations</span></code> we already conducted:</p>
<ul class="simple">
<li><p>(read in single participant data)</p></li>
<li><p>(explore single participant data)</p></li>
<li><p>(extract needed data from single participant data)</p></li>
<li><p>(convert extracted data to more intelligible form)</p>
<ul>
<li><p>(repeat for all participant data)</p></li>
<li><p>(combine all participant data in one file)</p></li>
</ul>
</li>
<li><p>(explore data from all participants)</p>
<ul>
<li><p>(general overview)</p></li>
<li><p>basic plots</p></li>
</ul>
</li>
<li><p>analyze data from all participant</p>
<ul>
<li><p>descriptive stats</p></li>
<li><p>inferential stats</p></li>
</ul>
</li>
</ul>
<p>Nice, that’s a lot. The next step on our list would be <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">explorations</span></code> by means of <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code> which will also lead to <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">analyzes</span></code>.</p>
</section>
<section id="recap-how-will-the-respective-steps-be-implemented">
<h3>Recap - how will the respective steps be implemented<a class="headerlink" href="#recap-how-will-the-respective-steps-be-implemented" title="Link to this heading">#</a></h3>
<p>After creating some sort of outline/workflow, we though about the respective steps in more detail and set overarching principles. Regarding the former, we also gathered a list of potentially useful <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">modules</span></code> to use. Given the pointers above, this entailed the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#"><span class="xref myst">numpy</span></a> and <a class="reference internal" href="#"><span class="xref myst">pandas</span></a> for data wrangling/exploration</p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">matplolib</span></a>, <a class="reference internal" href="#"><span class="xref myst">seaborn</span></a> and <a class="reference internal" href="#"><span class="xref myst">plotly</span></a> for data visualization</p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">pingouin</span></a> and <a class="reference internal" href="#"><span class="xref myst">statsmodels</span></a> for data analyzes/stats</p></li>
</ul>
<p>Regarding the second, we went back to standards and principles concerning computational work:</p>
<ul class="simple">
<li><p>use a dedicated computing environment</p></li>
<li><p>provide all steps and analyzes in a reproducible form</p></li>
<li><p>nothing will be done manually, everything will be coded</p></li>
<li><p>provide as much documentation as possible</p></li>
</ul>
<p><strong>Important</strong>: these aspects should be followed no matter what you’re working on!</p>
<p>So, after “getting ready” and conducted the first set of <code class="docutils literal notranslate"><span class="pre">processing</span> <span class="pre">steps</span></code>, it’s time to continue via <code class="docutils literal notranslate"><span class="pre">basic</span> <span class="pre">data</span> <span class="pre">visualization</span></code>.</p>
</section>
</section>
<section id="basic-data-visualization">
<h2>Basic data visualization<a class="headerlink" href="#basic-data-visualization" title="Link to this heading">#</a></h2>
<p>Given that we already explored our data a bit more, including the <code class="docutils literal notranslate"><span class="pre">basic</span> <span class="pre">descriptive</span> <span class="pre">statistics</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">types</span></code>, we will go one step further and continue this process via <code class="docutils literal notranslate"><span class="pre">basic</span> <span class="pre">data</span> <span class="pre">visualization</span></code> to get a different kind of overview that can potentially indicate important aspects concerning <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">analyses</span></code>. As mentioned above, we will do so via the following <code class="docutils literal notranslate"><span class="pre">steps</span></code>, addressing different aspects of <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code>. Throughout each, we will get to know respective <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">modules</span></code> and <code class="docutils literal notranslate"><span class="pre">functions</span></code>.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#"><span class="xref myst">Underlying principles</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">“standard” plots</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Going further with advanced plots</span></a></p></li>
</ul>
<section id="underlying-principles">
<h3>Underlying principles<a class="headerlink" href="#underlying-principles" title="Link to this heading">#</a></h3>
<p>When talking about <code class="docutils literal notranslate"><span class="pre">visualization</span></code> one might want to differentiate <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">exploration</span></code> and <code class="docutils literal notranslate"><span class="pre">analyses</span></code> but one can actually drastically influence the other. Here, we are going to check both, that is <code class="docutils literal notranslate"><span class="pre">facilitating</span> <span class="pre">data</span> <span class="pre">understanding</span> <span class="pre">in</span> <span class="pre">many</span> <span class="pre">ways</span></code> and <code class="docutils literal notranslate"><span class="pre">creating</span> <span class="pre">high</span> <span class="pre">quality</span> <span class="pre">results</span> <span class="pre">figures</span></code>.</p>
<p>Unsurprisingly, <code class="docutils literal notranslate"><span class="pre">python</span></code> is nothing but fantastic when it comes to <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">python</span></code> provides a wide array of options</p></li>
<li><p>Low-level and high-level plotting <code class="docutils literal notranslate"><span class="pre">API</span></code>s</p></li>
<li><p>static <code class="docutils literal notranslate"><span class="pre">images</span></code> vs. <code class="docutils literal notranslate"><span class="pre">HTML</span></code> output vs. <code class="docutils literal notranslate"><span class="pre">interactive</span> <span class="pre">plots</span></code></p></li>
<li><p>domain-general and domain-specific packages</p></li>
<li><p>optimal visualization environment as it’s both efficient and flexible</p>
<ul>
<li><p>produce off-the-shelf high-quality plots very quickly</p></li>
<li><p>with more effort, gives you full control over the plot</p></li>
</ul>
</li>
</ul>
<p>While <code class="docutils literal notranslate"><span class="pre">python</span></code> has a large amount of amazing modules targetting <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code>, we are going to utilize the three most common and general ones, as they provide the basis for everything else going further:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://matplotlib.org/">matplotlib</a></p></li>
<li><p><a class="reference external" href="http://seaborn.pydata.org/">seaborn</a></p></li>
<li><p>(<a class="reference external" href="https://plot.ly/python/">plotly</a>)</p></li>
</ul>
<p>The first two produce <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">images</span></code> and the last one HTML outputs and allow much more <code class="docutils literal notranslate"><span class="pre">interactive</span> <span class="pre">plots</span></code>. We will talk about each one as we go along.</p>
<section id="matplotlib">
<h4><a class="reference external" href="https://matplotlib.org/">matplotlib</a><a class="headerlink" href="#matplotlib" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>the most widely-used <code class="docutils literal notranslate"><span class="pre">python</span></code> plotting library</p></li>
<li><p>initially modeled on <code class="docutils literal notranslate"><span class="pre">MATLAB</span></code>’s plotting system</p></li>
<li><p>designed to provide complete control over a <code class="docutils literal notranslate"><span class="pre">plot</span></code></p></li>
</ul>
<center><img src="https://matplotlib.org/_static/images/logo2.svg" width="600px" style="margin-bottom: 10px;"></center><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and all other <code class="docutils literal notranslate"><span class="pre">high-level</span> <span class="pre">API</span></code>s that build upon it operate on <code class="docutils literal notranslate"><span class="pre">underlying</span> <span class="pre">principles</span></code> and respective <code class="docutils literal notranslate"><span class="pre">parts</span></code>:</p>
<center><img src="https://matplotlib.org/stable/_images/anatomy.png" width="600px" style="margin-bottom: 10px;"></center><p>In the most basic sense <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> graphs your data on <code class="docutils literal notranslate"><span class="pre">Figures</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">windows</span></code>, <code class="docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">widgets</span></code>, etc.), each of which can contain one or more <code class="docutils literal notranslate"><span class="pre">Axes</span></code>, an <code class="docutils literal notranslate"><span class="pre">area</span></code> where <code class="docutils literal notranslate"><span class="pre">points</span></code> can be specified in terms of <code class="docutils literal notranslate"><span class="pre">x-y</span> <span class="pre">coordinates</span></code> (or <code class="docutils literal notranslate"><span class="pre">theta-r</span></code> in a <code class="docutils literal notranslate"><span class="pre">polar</span> <span class="pre">plot</span></code>, <code class="docutils literal notranslate"><span class="pre">x-y-z</span></code> in a <code class="docutils literal notranslate"><span class="pre">3D</span> <span class="pre">plot</span></code>, etc.).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">figures</span></code></p>
<ul>
<li><p>the entire <code class="docutils literal notranslate"><span class="pre">graphic</span></code></p></li>
<li><p>keep track of everything therein (<code class="docutils literal notranslate"><span class="pre">axes</span></code>, <code class="docutils literal notranslate"><span class="pre">titles</span></code>, <code class="docutils literal notranslate"><span class="pre">legends</span></code>, etc.)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axes</span></code></p>
<ul>
<li><p>usually contains two or three <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">objects</span></code></p></li>
<li><p>includes <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">x-label</span></code>, <code class="docutils literal notranslate"><span class="pre">y-label</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ticks</span></code> and <code class="docutils literal notranslate"><span class="pre">tick</span> <span class="pre">labels</span></code> to provide <code class="docutils literal notranslate"><span class="pre">scale</span></code> for <code class="docutils literal notranslate"><span class="pre">data</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">artist</span></code></p>
<ul>
<li><p>everything visible on the <code class="docutils literal notranslate"><span class="pre">figure</span></code>: <code class="docutils literal notranslate"><span class="pre">text</span></code>, <code class="docutils literal notranslate"><span class="pre">lines</span></code>, <code class="docutils literal notranslate"><span class="pre">patches</span></code>, etc.</p></li>
<li><p>drawn to the <code class="docutils literal notranslate"><span class="pre">canvas</span></code></p></li>
</ul>
</li>
</ul>
<p>A bit too “theoretical”, eh? Let’s dive in and create some plots!</p>
<p>But before we start, two important points to remember: when <code class="docutils literal notranslate"><span class="pre">plotting</span></code> in <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebooks</span></code>, make sure to run the <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> <code class="docutils literal notranslate"><span class="pre">magic</span></code> before your first <code class="docutils literal notranslate"><span class="pre">graphic</span></code> which results in the <code class="docutils literal notranslate"><span class="pre">graphics</span></code> being embedded in the <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code> and not in the digital void. (NB: this is true for most but not all <code class="docutils literal notranslate"><span class="pre">plotting</span> <span class="pre">modules</span></code>/<code class="docutils literal notranslate"><span class="pre">functions</span></code>.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>When using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> you can choose between explicitly creating <code class="docutils literal notranslate"><span class="pre">Figures</span></code> and <code class="docutils literal notranslate"><span class="pre">axes</span></code> or use the <code class="docutils literal notranslate"><span class="pre">plt</span></code> interface to automatically create and manage them, as well as adding <code class="docutils literal notranslate"><span class="pre">graphics</span></code>. Quite often you might want to use the latter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="standard-plots">
<h4>standard plots<a class="headerlink" href="#standard-plots" title="Link to this heading">#</a></h4>
<p>Obviously, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> comes with support for all the “standard plots” out there: <a class="reference internal" href="#"><span class="xref myst">barplots</span></a>, <a class="reference internal" href="#"><span class="xref myst">scatterplots</span></a>, <a class="reference internal" href="#"><span class="xref myst">histograms</span></a>, <a class="reference internal" href="#"><span class="xref myst">boxplots</span></a>, <a class="reference internal" href="#"><span class="xref myst">errorbars</span></a>, etc. . For a great overview on what’s possible, make sure to check the <a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">gallery of the matplotlib documentation</a>. For now, we are going to start simply…how about some <code class="docutils literal notranslate"><span class="pre">univariate</span> <span class="pre">data</span> <span class="pre">visualization</span></code>, e.g. a <code class="docutils literal notranslate"><span class="pre">scatterplot</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># We don&#39;t have age in original dataset, so we will generate a random age for each unique participant</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>
<span class="n">participant_ages</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_long</span><span class="p">[[</span><span class="s1">&#39;participant&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;participant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()))</span>
<span class="p">)</span>

<span class="c1"># Map ages back to df_long</span>
<span class="n">df_long</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">participant_ages</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For example, we are interested in the <code class="docutils literal notranslate"><span class="pre">distribution</span></code> of <code class="docutils literal notranslate"><span class="pre">age</span></code> in our <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, we need to create a <code class="docutils literal notranslate"><span class="pre">figure</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code> something inside. As our data is in <code class="docutils literal notranslate"><span class="pre">long-format</span></code> we have to initially extract a <code class="docutils literal notranslate"><span class="pre">list</span></code> containing the <code class="docutils literal notranslate"><span class="pre">age</span></code> of each <code class="docutils literal notranslate"><span class="pre">participant</span></code> only once, using <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code> method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9ee05e537927cf24c1a2d28b125df8f659a5c0d19f8d5fb1ce7528eeb8cad276.png" src="../_images/9ee05e537927cf24c1a2d28b125df8f659a5c0d19f8d5fb1ce7528eeb8cad276.png" />
</div>
</div>
<p>While the information we wanted is there, the <code class="docutils literal notranslate"><span class="pre">plot</span></code> itself looks kinda cold and misses a few pieces to make it intelligible, e.g. <code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">labels</span></code> and a <code class="docutils literal notranslate"><span class="pre">title</span></code>. This can easily be added via <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>’s <code class="docutils literal notranslate"><span class="pre">plt</span></code> interface.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of age&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/583ca9fe16b9940862d1dbf7fd0b3bb803d9cca45f7cd7ea1a90c49900ba1d48.png" src="../_images/583ca9fe16b9940862d1dbf7fd0b3bb803d9cca45f7cd7ea1a90c49900ba1d48.png" />
</div>
</div>
<p>We could also add a <code class="docutils literal notranslate"><span class="pre">grid</span></code> to make it easier to situate the given <code class="docutils literal notranslate"><span class="pre">values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of age&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5db36dc43a9bb80dc10f33dd57116a7f10d45d48869abf6c4a4e5e2ebb6d7a0.png" src="../_images/f5db36dc43a9bb80dc10f33dd57116a7f10d45d48869abf6c4a4e5e2ebb6d7a0.png" />
</div>
</div>
<p>Nice, now we could also have a look at how meaningful values could interact using <code class="docutils literal notranslate"><span class="pre">scatter</span></code> plot. We want to check how the frame rate of the participant could affect the mean value of the reaction time of each participant. But for that, we need to learn <code class="docutils literal notranslate"><span class="pre">groupby</span></code></p>
</section>
</section>
<section id="introduction-to-groupby-in-pandas">
<h3>📊 Introduction to <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas<a class="headerlink" href="#introduction-to-groupby-in-pandas" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> method in Pandas is used for <strong>grouping data based on a column or multiple columns</strong> and then applying <strong>aggregations</strong> (e.g., mean, sum, count).</p>
<section id="why-use-groupby">
<h4><strong>Why Use <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>?</strong><a class="headerlink" href="#why-use-groupby" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>To <strong>summarize data</strong> by categories (e.g., average reaction time per participant).</p></li>
<li><p>To <strong>explore patterns</strong> and trends in grouped data.</p></li>
<li><p>To perform <strong>multi-level aggregations</strong> efficiently.</p></li>
</ul>
</section>
<section id="common-aggregations-with-groupby">
<h4><strong>Common Aggregations with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code></strong>:<a class="headerlink" href="#common-aggregations-with-groupby" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mean()</span></code> – Calculate the average value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sum()</span></code> – Get the total value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.count()</span></code> – Count the number of rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.median()</span></code> – Find the median value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.std()</span></code> – Calculate the standard deviation</p></li>
</ul>
</section>
<section id="groupby-workflow">
<h4><strong>GroupBy Workflow:</strong><a class="headerlink" href="#groupby-workflow" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Split</strong>: Group the data by unique values in a column.</p></li>
<li><p><strong>Apply</strong>: Perform an aggregation or transformation on each group.</p></li>
<li><p><strong>Combine</strong>: Return the results in a single DataFrame or Series.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="examples-of-groupby-in-pandas">
<h3>🐼 <strong>Examples of <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas:</strong><a class="headerlink" href="#examples-of-groupby-in-pandas" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1️⃣ Mean reaction time by participant:</span>
<span class="n">mean_rt</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># 2️⃣ Multiple aggregations for reaction time:</span>
<span class="n">mean_std_rt</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mean_rt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_std_rt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>participant
AG_01_02    0.814500
BF_31_01    0.691667
BF_31_02    0.714167
FB_09_02    0.584733
FB_09_03    0.594533
FK_24_01    1.603800
JB_22_01    0.541033
JB_22_02    0.569667
JB_22_03    0.545400
XY_16_03    0.671200
Name: resp.rt, dtype: float64
              resp.rt          
                 mean       std
participant                    
AG_01_02     0.814500  0.227043
BF_31_01     0.691667  0.231659
BF_31_02     0.714167  0.202041
FB_09_02     0.584733  0.212847
FB_09_03     0.594533  0.198665
FK_24_01     1.603800  1.505703
JB_22_01     0.541033  0.140593
JB_22_02     0.569667  0.166234
JB_22_03     0.545400  0.168221
XY_16_03     0.671200  0.166866
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3️⃣ Try to group by multiple columns (participant and congruent):</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frameRate_list</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;frameRate&#39;</span><span class="p">]</span>
<span class="n">rt_list</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">,</span> <span class="n">rt_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparing frame rate and reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a004b107c9d1b61a3b92c93db8ad72803f710f10a62288115781bc5959b20a1e.png" src="../_images/a004b107c9d1b61a3b92c93db8ad72803f710f10a62288115781bc5959b20a1e.png" />
</div>
</div>
<p>Sometimes, we might want to have different <code class="docutils literal notranslate"><span class="pre">subplots</span></code> within one main <code class="docutils literal notranslate"><span class="pre">plot</span></code>. Using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>’s <code class="docutils literal notranslate"><span class="pre">subplots</span></code> <code class="docutils literal notranslate"><span class="pre">function</span></code> makes this straightforward via two options: creating a <code class="docutils literal notranslate"><span class="pre">subplot</span></code> and adding the respective <code class="docutils literal notranslate"><span class="pre">graphics</span></code> or creating multiple <code class="docutils literal notranslate"><span class="pre">subplots</span></code> and adding the respective <code class="docutils literal notranslate"><span class="pre">graphics</span></code> via the <code class="docutils literal notranslate"><span class="pre">axes</span></code>. Let’s check the first option:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of frame rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">4.85</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">,</span> <span class="n">rt_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparing frame rate and reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8e5f439b9316a9535695da380008416e163075aa34b1e8f97b7136955cf5dd49.png" src="../_images/8e5f439b9316a9535695da380008416e163075aa34b1e8f97b7136955cf5dd49.png" />
</div>
</div>
<p>Hm, kinda ok but we would need to adapt the <code class="docutils literal notranslate"><span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">spacing</span></code>. This is actually easier using the second option, <code class="docutils literal notranslate"><span class="pre">subplots()</span></code>, which is also recommended by the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> community:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">,</span> <span class="n">rt_list</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparing Frame Rate and Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc2fa0048d771fcfa05d8dca6283317022bd60127a9b873234e18f5ae25c1085.png" src="../_images/dc2fa0048d771fcfa05d8dca6283317022bd60127a9b873234e18f5ae25c1085.png" />
</div>
</div>
<p>As <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> provides access to all parts of a <code class="docutils literal notranslate"><span class="pre">figure</span></code>, we could furthermore adapt various aspects, e.g. the <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> of the <code class="docutils literal notranslate"><span class="pre">draw</span></code>n <code class="docutils literal notranslate"><span class="pre">markers</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">,</span> <span class="n">rt_list</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frame Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparing Frame Rate and Reaction time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d82fb1bbd5aaaeabde0089a8b9cf1a61f397a795aeb048c99dcf5002bdd9df33.png" src="../_images/d82fb1bbd5aaaeabde0089a8b9cf1a61f397a795aeb048c99dcf5002bdd9df33.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Now its your turn! Try to plot hist plot for reaction time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Now its your turn! Try to plot scatter plot for reaction time vs congruency</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Now its your turn! Try to boxplot reaction time on y-axis and condition on x-axis</span>
<span class="c1"># Group data by &#39;congruent&#39; and create a list of &#39;resp.rt&#39; values</span>
<span class="c1"># Collect reaction times based on congruency</span>
<span class="n">congruent_0</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;congruent&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">congruent_1</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;congruent&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Combine into a list for boxplot</span>
<span class="n">congruent_lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">congruent_0</span><span class="p">,</span> <span class="n">congruent_1</span><span class="p">]</span>
<span class="c1"># Create the boxplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This provides just a glimpse but <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is infinitely customizable, thus as in most modern <code class="docutils literal notranslate"><span class="pre">plotting</span></code> environments, you can do virtually anything. The problem is: you just have to be willing to spend enough time on it. Lucky for us and everyone else there are many <code class="docutils literal notranslate"><span class="pre">modules</span></code>/<code class="docutils literal notranslate"><span class="pre">libraries</span></code> that provide a high-level interface to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. However, before we check one of them out we should quickly summarize <code class="docutils literal notranslate"><span class="pre">pros</span></code> and <code class="docutils literal notranslate"><span class="pre">cons</span></code> of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<section id="pros">
<h4>Pros<a class="headerlink" href="#pros" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>provides low-level control over virtually every element of a <code class="docutils literal notranslate"><span class="pre">plot</span></code></p></li>
<li><p>completely <code class="docutils literal notranslate"><span class="pre">object-oriented</span> <span class="pre">API</span></code>; <code class="docutils literal notranslate"><span class="pre">plot</span></code> components can be easily modified</p></li>
<li><p>close integration with <code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p>extremely active community</p></li>
<li><p>tons of functionality (<code class="docutils literal notranslate"><span class="pre">figure</span> <span class="pre">compositing</span></code>, <code class="docutils literal notranslate"><span class="pre">layering</span></code>, <code class="docutils literal notranslate"><span class="pre">annotation</span></code>, <code class="docutils literal notranslate"><span class="pre">coordinate</span> <span class="pre">transformations</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">mapping</span></code>, etc.)</p></li>
</ul>
</section>
<section id="cons">
<h4>Cons<a class="headerlink" href="#cons" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>steep learning curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">API</span></code> is extremely unpredictable–redundancy and inconsistency are common</p></li>
<li><p>some simple things are hard; some complex things are easy</p></li>
<li><p>lacks systematicity/organizing <code class="docutils literal notranslate"><span class="pre">syntax</span></code>–every <code class="docutils literal notranslate"><span class="pre">plot</span></code> is its own little world</p></li>
<li><p>simple <code class="docutils literal notranslate"><span class="pre">plots</span></code> often require a lot of <code class="docutils literal notranslate"><span class="pre">code</span></code></p></li>
<li><p>default <code class="docutils literal notranslate"><span class="pre">styles</span></code> are not optimal</p></li>
</ul>
</section>
<section id="high-level-interfaces-to-matplotlib">
<h4>High-level interfaces to matplotlib<a class="headerlink" href="#high-level-interfaces-to-matplotlib" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is very powerful and very robust, but the <code class="docutils literal notranslate"><span class="pre">API</span></code> is hit-and-miss</p></li>
<li><p>many high-level interfaces to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> have been written</p></li>
<li><p>abstract away many of the annoying details</p></li>
<li><p>best of both worlds: easy generation of <code class="docutils literal notranslate"><span class="pre">plots</span></code>, but retain <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>’s power</p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Seaborn</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">ggplot</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">pandas</span></a></p></li>
<li><p>etc.</p></li>
</ul>
</li>
<li><p>many domain-specific <code class="docutils literal notranslate"><span class="pre">visualization</span></code> tools are built on <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">nilearn</span></code> and <code class="docutils literal notranslate"><span class="pre">mne</span></code> in <code class="docutils literal notranslate"><span class="pre">neuroimaging</span></code>)</p></li>
</ul>
</section>
</section>
<section id="going-further-with-advanced-plots">
<h3>Going further with advanced plots<a class="headerlink" href="#going-further-with-advanced-plots" title="Link to this heading">#</a></h3>
<p>This also marks the transition to more “advanced plots” as the respective libraries allow you to create fantastic and complex <code class="docutils literal notranslate"><span class="pre">plots</span></code> with ease!</p>
<section id="seaborn">
<h4><a class="reference internal" href="#"><span class="xref myst">Seaborn</span></a><a class="headerlink" href="#seaborn" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> abstracts away many of the complexities to deal with such minutiae and provides a <code class="docutils literal notranslate"><span class="pre">high-level</span> <span class="pre">API</span></code> for creating aesthetic <code class="docutils literal notranslate"><span class="pre">plots</span></code>.</p>
<ul class="simple">
<li><p>arguably the premier <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> <code class="docutils literal notranslate"><span class="pre">interface</span></code> for <code class="docutils literal notranslate"><span class="pre">high-level</span> <span class="pre">plots</span></code></p></li>
<li><p>generates beautiful <code class="docutils literal notranslate"><span class="pre">plots</span></code> in very little <code class="docutils literal notranslate"><span class="pre">code</span></code></p></li>
<li><p>beautiful <code class="docutils literal notranslate"><span class="pre">styles</span></code> and <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">palettes</span></code></p></li>
<li><p>wide range of supported plots</p></li>
<li><p>modest support for structured <code class="docutils literal notranslate"><span class="pre">plotting</span></code> (via <code class="docutils literal notranslate"><span class="pre">grids</span></code>)</p></li>
<li><p>exceptional <a class="reference internal" href="#"><span class="xref myst">documentation</span></a></p></li>
<li><p>generally, the best place to start when <code class="docutils literal notranslate"><span class="pre">exploring</span></code> and <code class="docutils literal notranslate"><span class="pre">visualizing</span> <span class="pre">data</span></code></p></li>
<li><p>(can be quite slow (e.g., with <code class="docutils literal notranslate"><span class="pre">permutation</span></code>))</p></li>
</ul>
<center><img src="https://seaborn.pydata.org/_static/logo-wide-lightbg.svg" width="600px" style="margin-bottom: 10px;"></center><p>For example, recreating the <code class="docutils literal notranslate"><span class="pre">plots</span></code> from above is as easy as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_long</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/89119c80b25da9796dcae613ad8444420b6009e29b37bf0a09ecf99fa3845004.png" src="../_images/89119c80b25da9796dcae613ad8444420b6009e29b37bf0a09ecf99fa3845004.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">frameRate_list</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">rt_list</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparing frame rate and reaction time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b52ad8b8b2ac452f26b204ac82819a8e27cafd5d0a2058d70ae1cf0e1748fb7f.png" src="../_images/b52ad8b8b2ac452f26b204ac82819a8e27cafd5d0a2058d70ae1cf0e1748fb7f.png" />
</div>
</div>
<p>You might wonder: “well, that doesn’t look so different from the <code class="docutils literal notranslate"><span class="pre">plots</span></code> we created before and it’s also not way faster/easier”.</p>
<p>True that, but so far this based on our <code class="docutils literal notranslate"><span class="pre">data</span></code> and the things we wanted to <code class="docutils literal notranslate"><span class="pre">plot</span></code>. <code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> actually integrates fantastically with <code class="docutils literal notranslate"><span class="pre">pandas</span> <span class="pre">dataframes</span></code> and allows to achieve amazing things rather easily.</p>
<p>Let’s go through some examples!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_long</span><span class="p">[[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="s1">&#39;resp.corr&#39;</span><span class="p">,</span><span class="s1">&#39;congruent&#39;</span><span class="p">]],</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;congruent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6f86cb3b5ef03430c20b18f2a8a4d0feb463d1d25faf0339cac5ad6103b36776.png" src="../_images/6f86cb3b5ef03430c20b18f2a8a4d0feb463d1d25faf0339cac5ad6103b36776.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_long</span><span class="p">[[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="s1">&#39;resp.corr&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]],</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5a625a2d149cb1d07ecd1575b62048683dd899be8606bd22273a09fe1ecace53.png" src="../_images/5a625a2d149cb1d07ecd1575b62048683dd899be8606bd22273a09fe1ecace53.png" />
</div>
</div>
<p>And can now make use of the fantastic <code class="docutils literal notranslate"><span class="pre">pandas</span></code> - <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> friendship. For example, let’s go back to the <code class="docutils literal notranslate"><span class="pre">scatterplot</span></code> of <code class="docutils literal notranslate"><span class="pre">frameRate</span></code> and <code class="docutils literal notranslate"><span class="pre">resp.rt</span></code> we did before. How could we improve this <code class="docutils literal notranslate"><span class="pre">plot</span></code>? Maybe adding the <code class="docutils literal notranslate"><span class="pre">distribution</span></code> of each <code class="docutils literal notranslate"><span class="pre">variable</span></code> to it? That’s easily done via <code class="docutils literal notranslate"><span class="pre">jointplot()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;frameRate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/423f81643cef0b6c42b8b48a91645437329edb4afbd062be8b2d82bd3e379ee9.png" src="../_images/423f81643cef0b6c42b8b48a91645437329edb4afbd062be8b2d82bd3e379ee9.png" />
</div>
</div>
<p>Wouldn’t it be cool if we could also briefly explore if there might be some statistically relevant effects going on here? Say no more, as we can add a <code class="docutils literal notranslate"><span class="pre">regression</span></code> to the <code class="docutils literal notranslate"><span class="pre">plot</span></code> via setting the <code class="docutils literal notranslate"><span class="pre">kind</span></code> <code class="docutils literal notranslate"><span class="pre">argument</span></code> to <code class="docutils literal notranslate"><span class="pre">reg</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;frameRate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/130609fae45561524d2bf37dbb4f39f9bf941bff9aefa7cf8f50759b6d9455e6.png" src="../_images/130609fae45561524d2bf37dbb4f39f9bf941bff9aefa7cf8f50759b6d9455e6.png" />
</div>
</div>
<p>Chances are we see another manifestation of <code class="docutils literal notranslate"><span class="pre">early</span> <span class="pre">onset</span> <span class="pre">grumpiness</span></code> here and thus might want to spend a closer look on the <code class="docutils literal notranslate"><span class="pre">ratings</span></code> for each <code class="docutils literal notranslate"><span class="pre">movie</span></code>. One possibility to do so, could be a <code class="docutils literal notranslate"><span class="pre">boxplot()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;congruent&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;congruent&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ec644fc47dc25317024200bd47800339d79b1122a6756c83e2e96fb71295ebb5.png" src="../_images/ec644fc47dc25317024200bd47800339d79b1122a6756c83e2e96fb71295ebb5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#now its your turn! make boxplot for each text vs resp.rt</span>
</pre></div>
</div>
</div>
</div>
<p>However, we know that <code class="docutils literal notranslate"><span class="pre">boxplot</span></code>s have their fair share of problems…given that they show <code class="docutils literal notranslate"><span class="pre">summary</span> <span class="pre">statistics</span></code>, <code class="docutils literal notranslate"><span class="pre">clusters</span></code> and <code class="docutils literal notranslate"><span class="pre">multimodalities</span></code> are hidden..</p>
<center><img src="https://annalloyd.files.wordpress.com/2019/02/boxplots.gif" width="600px" style="margin-bottom: 10px;"></center><p>That’s actually one important aspect everyone should remember concerning <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">visualization</span></code>, no matter if for <code class="docutils literal notranslate"><span class="pre">exploration</span></code> or <code class="docutils literal notranslate"><span class="pre">analyses</span></code>: show as much <code class="docutils literal notranslate"><span class="pre">data</span></code> and information as possible! With <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> we can easily address this via adding <code class="docutils literal notranslate"><span class="pre">individual</span> <span class="pre">data</span> <span class="pre">points</span></code> to our <code class="docutils literal notranslate"><span class="pre">plot</span></code> via <code class="docutils literal notranslate"><span class="pre">stripplot()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/72e0e85a1e1450bf672495af1d808225450e63ae93ef2f3fd616d63c1cf463f0.png" src="../_images/72e0e85a1e1450bf672495af1d808225450e63ae93ef2f3fd616d63c1cf463f0.png" />
</div>
</div>
<p>Ah yes, that’s better! Seeing the <code class="docutils literal notranslate"><span class="pre">individual</span> <span class="pre">data</span> <span class="pre">points</span></code>, we might want to check the respective <code class="docutils literal notranslate"><span class="pre">distributions</span></code>. Using <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>’s <code class="docutils literal notranslate"><span class="pre">violinplot()</span></code>, this is done in no time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d70ec11f98538c80a1f0e18bf73ea4d8493016b94997d2e0d496185a7f9c75da.png" src="../_images/d70ec11f98538c80a1f0e18bf73ea4d8493016b94997d2e0d496185a7f9c75da.png" />
</div>
</div>
<p>As you might have seen, we also adapted the style of our <code class="docutils literal notranslate"><span class="pre">plot</span></code> a bit via <code class="docutils literal notranslate"><span class="pre">sns.despine()</span></code> which removed the <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">axis</span> <span class="pre">spine</span></code>. This actually outlines another important point: <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> is fantastic when it comes to customizing <code class="docutils literal notranslate"><span class="pre">plots</span></code> with little effort (i.e. getting rid of many lines of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> <code class="docutils literal notranslate"><span class="pre">code</span></code>). This includes “<code class="docutils literal notranslate"><span class="pre">themes</span></code>, <code class="docutils literal notranslate"><span class="pre">context</span></code>s, <code class="docutils literal notranslate"><span class="pre">colormaps</span></code> among other things.</p>
<p>Starting with <code class="docutils literal notranslate"><span class="pre">themes</span></code>, which set a variety of <code class="docutils literal notranslate"><span class="pre">aesthetic</span></code> related factors, including <code class="docutils literal notranslate"><span class="pre">background</span> <span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">grid</span></code>s, etc., here are some very different examples showcasing the <code class="docutils literal notranslate"><span class="pre">whitegrid</span></code> style</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a302348499ef0f3aa236d1ecdd476fca25b9e0d005fa1f673f27ca3e5813d508.png" src="../_images/a302348499ef0f3aa236d1ecdd476fca25b9e0d005fa1f673f27ca3e5813d508.png" />
</div>
</div>
<p>and the <code class="docutils literal notranslate"><span class="pre">dark</span></code> style:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3bf28c2322a76129bb822c5f6a811627de03ecfc5f09f05fe23b8e8772b12f16.png" src="../_images/3bf28c2322a76129bb822c5f6a811627de03ecfc5f09f05fe23b8e8772b12f16.png" />
</div>
</div>
<p>While this is already super cool, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> goes one step further and even let’s you define the <code class="docutils literal notranslate"><span class="pre">context</span></code> for which your <code class="docutils literal notranslate"><span class="pre">figure</span></code> is intended and adapts it accordingly. For example, there’s a big difference if you want to include your <code class="docutils literal notranslate"><span class="pre">figure</span></code> in a <code class="docutils literal notranslate"><span class="pre">poster</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;poster&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fa6df5cc525bcf788f4b6d77517ebf4ba1bbc073f914d7df6ec4471899e5da6a.png" src="../_images/fa6df5cc525bcf788f4b6d77517ebf4ba1bbc073f914d7df6ec4471899e5da6a.png" />
</div>
</div>
<p>or a <code class="docutils literal notranslate"><span class="pre">talk</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cb57d9526816972ad77e2a180c96687d03c72589fccd5420da56162c348d4282.png" src="../_images/cb57d9526816972ad77e2a180c96687d03c72589fccd5420da56162c348d4282.png" />
</div>
</div>
<p>or a <code class="docutils literal notranslate"><span class="pre">paper</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5d501a6f390011dd8dc6c61069c16fef4bc8077a644ae741a0b92f8dc2f88674.png" src="../_images/5d501a6f390011dd8dc6c61069c16fef4bc8077a644ae741a0b92f8dc2f88674.png" />
</div>
</div>
<p>No matter the <code class="docutils literal notranslate"><span class="pre">figure</span></code> and <code class="docutils literal notranslate"><span class="pre">context</span></code>, another very crucial aspect everyone should always look out for is the <code class="docutils literal notranslate"><span class="pre">colormap</span></code> or <code class="docutils literal notranslate"><span class="pre">colorpalette</span></code>! Some of the most common ones are actually suboptimal in multiple regards. This entails a misrepresentation of <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_1.png" width="600px" style="margin-bottom: 10px;"></center><center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_2.png" width="800px" style="margin-bottom: 10px;"></center><center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_3.png" width="800px" style="margin-bottom: 10px;"></center><p>It gets even worse: they don’t work for people with <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">vision</span> <span class="pre">deficiencies</span></code>!</p>
<center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_4.png" width="800px" style="margin-bottom: 10px;"></center><p>That’s obviously not ok and we/you need to address this! With <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, some of these important aspects are easily addressed. For example, via setting the <code class="docutils literal notranslate"><span class="pre">colorpalette</span></code> to <code class="docutils literal notranslate"><span class="pre">colorblind</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bd1738af6ad2f86c05dde6ef08f078710a5c87f106f6a48dd32a5167006f525f.png" src="../_images/bd1738af6ad2f86c05dde6ef08f078710a5c87f106f6a48dd32a5167006f525f.png" />
</div>
</div>
<p>or using one of the suitable <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">palettes</span></code> that also address the <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">representation</span> <span class="pre">problem</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">perceptually</span> <span class="pre">uniform</span> <span class="pre">color</span> <span class="pre">palettes</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;flare&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="vertical-align: middle;"><strong>flare</strong> </div><div class="cmap"><img alt="flare colormap" title="flare" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAFHRFWHRUaXRsZQBmbGFyZSBjb2xvcm1hcPBwCaYAAAAadEVYdERlc2NyaXB0aW9uAGZsYXJlIGNvbG9ybWFwDi+gQAAAADB0RVh0QXV0aG9yAE1hdHBsb3RsaWIgdjMuNC4zLCBodHRwczovL21hdHBsb3RsaWIub3JnCV3z0wAAADJ0RVh0U29mdHdhcmUATWF0cGxvdGxpYiB2My40LjMsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcn+2z0AAAB4UlEQVR4nO3WQXKDMBBFwSEnz41ysdxBWcQhBXgssL373RsKNBbCq7d8f32Oqqoav5e6Xfr7yVxt58ar+zX3403n7fc5e47Xvuf8d2xvp3PVzXXnn73v7Prjc87nHz9v52q59LsxbvP7Y65zy/b+MHf/9+vvTs63z2vZ3Xf7N++ryb4n3/d/bc7TnWN/fXm9Of9h/U/3ne/Zv1uv9fmz77+2XpP10/s/Obe+/7Zyfb9xbW667/Zgx/nmnOtct969//78+v7Zfofv6P7H7fP//a/9bn/+jwIA4ggAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAg0A/eZmRcQvs67gAAAABJRU5ErkJggg=="></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#edb081ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #edb081ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#4b2362ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #4b2362ff;"></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;crest&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="vertical-align: middle;"><strong>crest</strong> </div><div class="cmap"><img alt="crest colormap" title="crest" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAFHRFWHRUaXRsZQBjcmVzdCBjb2xvcm1hcDDWw8gAAAAadEVYdERlc2NyaXB0aW9uAGNyZXN0IGNvbG9ybWFwzolqLgAAADB0RVh0QXV0aG9yAE1hdHBsb3RsaWIgdjMuNC4zLCBodHRwczovL21hdHBsb3RsaWIub3JnCV3z0wAAADJ0RVh0U29mdHdhcmUATWF0cGxvdGxpYiB2My40LjMsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcn+2z0AAAB3UlEQVR4nO3WMXLbMBRAQcj3L3KIHCdnMlPEyoxBIWBkjZu320igwU/IbN7t568fxxhjHOOP4+PLdv3x+X7ad/u/OdP6PO9V57qvj+85x2L9fjx33249vjp3cX3M+zb3jc2++1+e/T37+a+Zd77++QGvn//4/Pcv2/dy9fdvz7H4navzPXuO077j4r6r8xbr1XOm9fL6ad7jQfPz5/vn55xfxG7/dJDF/tvT+x+f57aZ8/f+0wv49/zVOXfn38+7dv3y85bvabp/+X9e7JuONV9fz12c5+L9bwMAyBEAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIJ+A9tsQVtfMWhrAAAAAElFTkSuQmCC"></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#a5cd90ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #a5cd90ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#2c3172ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #2c3172ff;"></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">cubehelix_palette</span><span class="p">(</span><span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="vertical-align: middle;"><strong>seaborn_cubehelix</strong> </div><div class="cmap"><img alt="seaborn_cubehelix colormap" title="seaborn_cubehelix" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAIHRFWHRUaXRsZQBzZWFib3JuX2N1YmVoZWxpeCBjb2xvcm1hcCHoIPcAAAAmdEVYdERlc2NyaXB0aW9uAHNlYWJvcm5fY3ViZWhlbGl4IGNvbG9ybWFwGlvH/wAAADB0RVh0QXV0aG9yAE1hdHBsb3RsaWIgdjMuNC4zLCBodHRwczovL21hdHBsb3RsaWIub3JnCV3z0wAAADJ0RVh0U29mdHdhcmUATWF0cGxvdGxpYiB2My40LjMsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcn+2z0AAACAElEQVR4nO3WTU7rMACFUcP+d8aIhbAFu4M2QfinDlVn95wJD8exHaMnfR8/31+tlFJKvf84tNaOf8zHH/Nb9/yYP4zv5tfNfv34dn4378Xznb/25xzWK/Px5XeX6fjvd/XLdevUzfPtPv3559893tNivW7+6+91xz/vsfQPns9ffffm3t+23sXxYb/NOeqbz1Ev3uPqHOP8zXtlPt6f513nWD2v5do99feze36Ol9X/q+d/x3O9xflqm6+7em95vv6ehv3an3n9+Hqf5+/9d5/VPS7voWzOUVb71dfWe7x3/bvq5hzHd9f5+Ha9+Xvjd93nfRYAII4AAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAt0AVjvHFbQUd1kAAAAASUVORK5CYII="></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#edd1cbff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #edd1cbff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#2d1e3eff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #2d1e3eff;"></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">cubehelix_palette</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">rot</span><span class="o">=-</span><span class="mf">.5</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="vertical-align: middle;"><strong>seaborn_cubehelix</strong> </div><div class="cmap"><img alt="seaborn_cubehelix colormap" title="seaborn_cubehelix" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAIHRFWHRUaXRsZQBzZWFib3JuX2N1YmVoZWxpeCBjb2xvcm1hcCHoIPcAAAAmdEVYdERlc2NyaXB0aW9uAHNlYWJvcm5fY3ViZWhlbGl4IGNvbG9ybWFwGlvH/wAAADB0RVh0QXV0aG9yAE1hdHBsb3RsaWIgdjMuNC4zLCBodHRwczovL21hdHBsb3RsaWIub3JnCV3z0wAAADJ0RVh0U29mdHdhcmUATWF0cGxvdGxpYiB2My40LjMsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcn+2z0AAACBUlEQVR4nO3WwVXDMBRFQUH/VdEEDVCHxCYmWPa3nGzfzC5KJP+IcM79+Pr5Hq211tto/43Hyz7269vrbXm06/dvrz/O6dP7Y1yvr54z5vnb+Xr1fedzjnNcn/fq/Kvzqnss9/XVfPfmr/Y9n3N97+W++fv0N/dNc7QXv1db3tPYfW41x7Ywis+X8z1/oOf7FnMe9k33cTxvMf/xH+z683/Pu57/sL583vkPfr7f+Qfz+nnFevVDLM/rb51X31/fr5f79heyfk4v5t/mPPzB9vufB+7OKe/jcH/V8987b76n0Yv5D/d0d47qfs/Xl8+5Ocdyva32nd/DZwMA4ggAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAgkAAAgEACAAACCQAACCQAACCQAACAQAIAAAIJAAAIJAAAIJAAAIBAAgAAAgkAAAgkAAAg0C+nHbUWkJHiyQAAAABJRU5ErkJggg=="></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#c2e5d8ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #c2e5d8ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#311c3bff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #311c3bff;"></div></div></div></div>
</div>
<p>Let’s see a few of those in action, for example within a <code class="docutils literal notranslate"><span class="pre">heatmap</span></code> that displays the <code class="docutils literal notranslate"><span class="pre">correlation</span></code> between <code class="docutils literal notranslate"><span class="pre">ratings</span></code> of <code class="docutils literal notranslate"><span class="pre">movies</span></code>. For this, we need to <code class="docutils literal notranslate"><span class="pre">reshape</span></code> our <code class="docutils literal notranslate"><span class="pre">data</span></code> back to <code class="docutils literal notranslate"><span class="pre">wide-format</span></code> which is straightforward using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>’ <a class="reference internal" href="#"><span class="xref myst">pivot</span></a> <code class="docutils literal notranslate"><span class="pre">function</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pivot df_long to wide format</span>
<span class="n">df_wide</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;congruent&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;letterColor&#39;</span><span class="p">],</span> 
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span>  <span class="c1"># Use mean if multiple values exist per condition</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>congruent</th>
      <th colspan="3" halign="left">0.0</th>
      <th colspan="3" halign="left">1.0</th>
    </tr>
    <tr>
      <th>text</th>
      <th>blue</th>
      <th>green</th>
      <th>red</th>
      <th>blue</th>
      <th>green</th>
      <th>red</th>
    </tr>
    <tr>
      <th>letterColor</th>
      <th>red</th>
      <th>blue</th>
      <th>green</th>
      <th>blue</th>
      <th>green</th>
      <th>red</th>
    </tr>
    <tr>
      <th>participant</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AG_01_02</th>
      <td>1.0116</td>
      <td>1.0154</td>
      <td>0.8174</td>
      <td>0.7612</td>
      <td>0.5682</td>
      <td>0.7132</td>
    </tr>
    <tr>
      <th>BF_31_01</th>
      <td>0.7160</td>
      <td>0.7048</td>
      <td>0.6294</td>
      <td>0.7492</td>
      <td>0.6210</td>
      <td>0.7296</td>
    </tr>
    <tr>
      <th>BF_31_02</th>
      <td>0.7150</td>
      <td>0.8726</td>
      <td>0.7404</td>
      <td>0.6372</td>
      <td>0.6338</td>
      <td>0.6860</td>
    </tr>
    <tr>
      <th>FB_09_02</th>
      <td>0.5958</td>
      <td>0.4744</td>
      <td>0.5816</td>
      <td>0.6554</td>
      <td>0.5906</td>
      <td>0.6106</td>
    </tr>
    <tr>
      <th>FB_09_03</th>
      <td>0.5774</td>
      <td>0.6770</td>
      <td>0.5604</td>
      <td>0.6946</td>
      <td>0.4944</td>
      <td>0.5634</td>
    </tr>
    <tr>
      <th>FK_24_01</th>
      <td>1.7914</td>
      <td>1.0746</td>
      <td>2.6864</td>
      <td>1.3936</td>
      <td>1.3048</td>
      <td>1.3720</td>
    </tr>
    <tr>
      <th>JB_22_01</th>
      <td>0.4814</td>
      <td>0.6286</td>
      <td>0.6164</td>
      <td>0.4746</td>
      <td>0.5226</td>
      <td>0.5226</td>
    </tr>
    <tr>
      <th>JB_22_02</th>
      <td>0.5252</td>
      <td>0.6798</td>
      <td>0.5054</td>
      <td>0.5222</td>
      <td>0.5902</td>
      <td>0.5952</td>
    </tr>
    <tr>
      <th>JB_22_03</th>
      <td>0.5910</td>
      <td>0.6402</td>
      <td>0.5164</td>
      <td>0.5020</td>
      <td>0.4728</td>
      <td>0.5500</td>
    </tr>
    <tr>
      <th>XY_16_03</th>
      <td>0.6842</td>
      <td>0.7708</td>
      <td>0.5328</td>
      <td>0.6834</td>
      <td>0.8144</td>
      <td>0.5416</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset column names for clarity</span>
<span class="n">df_wide</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;rt_congruent</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">_text</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">_color</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_wide</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rt_congruent0.0_textblue_colorred</th>
      <th>rt_congruent0.0_textgreen_colorblue</th>
      <th>rt_congruent0.0_textred_colorgreen</th>
      <th>rt_congruent1.0_textblue_colorblue</th>
      <th>rt_congruent1.0_textgreen_colorgreen</th>
      <th>rt_congruent1.0_textred_colorred</th>
    </tr>
    <tr>
      <th>participant</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AG_01_02</th>
      <td>1.0116</td>
      <td>1.0154</td>
      <td>0.8174</td>
      <td>0.7612</td>
      <td>0.5682</td>
      <td>0.7132</td>
    </tr>
    <tr>
      <th>BF_31_01</th>
      <td>0.7160</td>
      <td>0.7048</td>
      <td>0.6294</td>
      <td>0.7492</td>
      <td>0.6210</td>
      <td>0.7296</td>
    </tr>
    <tr>
      <th>BF_31_02</th>
      <td>0.7150</td>
      <td>0.8726</td>
      <td>0.7404</td>
      <td>0.6372</td>
      <td>0.6338</td>
      <td>0.6860</td>
    </tr>
    <tr>
      <th>FB_09_02</th>
      <td>0.5958</td>
      <td>0.4744</td>
      <td>0.5816</td>
      <td>0.6554</td>
      <td>0.5906</td>
      <td>0.6106</td>
    </tr>
    <tr>
      <th>FB_09_03</th>
      <td>0.5774</td>
      <td>0.6770</td>
      <td>0.5604</td>
      <td>0.6946</td>
      <td>0.4944</td>
      <td>0.5634</td>
    </tr>
    <tr>
      <th>FK_24_01</th>
      <td>1.7914</td>
      <td>1.0746</td>
      <td>2.6864</td>
      <td>1.3936</td>
      <td>1.3048</td>
      <td>1.3720</td>
    </tr>
    <tr>
      <th>JB_22_01</th>
      <td>0.4814</td>
      <td>0.6286</td>
      <td>0.6164</td>
      <td>0.4746</td>
      <td>0.5226</td>
      <td>0.5226</td>
    </tr>
    <tr>
      <th>JB_22_02</th>
      <td>0.5252</td>
      <td>0.6798</td>
      <td>0.5054</td>
      <td>0.5222</td>
      <td>0.5902</td>
      <td>0.5952</td>
    </tr>
    <tr>
      <th>JB_22_03</th>
      <td>0.5910</td>
      <td>0.6402</td>
      <td>0.5164</td>
      <td>0.5020</td>
      <td>0.4728</td>
      <td>0.5500</td>
    </tr>
    <tr>
      <th>XY_16_03</th>
      <td>0.6842</td>
      <td>0.7708</td>
      <td>0.5328</td>
      <td>0.6834</td>
      <td>0.8144</td>
      <td>0.5416</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#wow thats cool! can you try to do similar to resp.corr? but use date as index, and aggregate by congruent and corrAns  </span>
</pre></div>
</div>
</div>
</div>
<p>Then we can use another <code class="docutils literal notranslate"><span class="pre">built-in</span> <span class="pre">function</span></code> of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">dataframes</span></code>: <code class="docutils literal notranslate"><span class="pre">.corr()</span></code>, which computes a correlation between all <code class="docutils literal notranslate"><span class="pre">columns</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_wide</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x700 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/71afe05dd62a8a69d9034bb707fe9f78151c6277eb758ee7d00324dcfaabb9ff.png" src="../_images/71afe05dd62a8a69d9034bb707fe9f78151c6277eb758ee7d00324dcfaabb9ff.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wide</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rt_congruent0.0_textblue_colorred</th>
      <th>rt_congruent0.0_textgreen_colorblue</th>
      <th>rt_congruent0.0_textred_colorgreen</th>
      <th>rt_congruent1.0_textblue_colorblue</th>
      <th>rt_congruent1.0_textgreen_colorgreen</th>
      <th>rt_congruent1.0_textred_colorred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rt_congruent0.0_textblue_colorred</th>
      <td>1.000000</td>
      <td>0.812087</td>
      <td>0.959666</td>
      <td>0.961608</td>
      <td>0.887717</td>
      <td>0.965283</td>
    </tr>
    <tr>
      <th>rt_congruent0.0_textgreen_colorblue</th>
      <td>0.812087</td>
      <td>1.000000</td>
      <td>0.692348</td>
      <td>0.703376</td>
      <td>0.638695</td>
      <td>0.708970</td>
    </tr>
    <tr>
      <th>rt_congruent0.0_textred_colorgreen</th>
      <td>0.959666</td>
      <td>0.692348</td>
      <td>1.000000</td>
      <td>0.940903</td>
      <td>0.911372</td>
      <td>0.976929</td>
    </tr>
    <tr>
      <th>rt_congruent1.0_textblue_colorblue</th>
      <td>0.961608</td>
      <td>0.703376</td>
      <td>0.940903</td>
      <td>1.000000</td>
      <td>0.907014</td>
      <td>0.957430</td>
    </tr>
    <tr>
      <th>rt_congruent1.0_textgreen_colorgreen</th>
      <td>0.887717</td>
      <td>0.638695</td>
      <td>0.911372</td>
      <td>0.907014</td>
      <td>1.000000</td>
      <td>0.893670</td>
    </tr>
    <tr>
      <th>rt_congruent1.0_textred_colorred</th>
      <td>0.965283</td>
      <td>0.708970</td>
      <td>0.976929</td>
      <td>0.957430</td>
      <td>0.893670</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nice, how does the <code class="docutils literal notranslate"><span class="pre">crest</span></code> <code class="docutils literal notranslate"><span class="pre">palette</span></code> look?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_wide</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;crest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ef139834d2d868d1f7f62b98737ca2c018923b8923efe9ea448f2fbae44e2740.png" src="../_images/ef139834d2d868d1f7f62b98737ca2c018923b8923efe9ea448f2fbae44e2740.png" />
</div>
</div>
<p>While we’re at it, we also change <code class="docutils literal notranslate"><span class="pre">heatmap</span></code> to <code class="docutils literal notranslate"><span class="pre">clustermap</span></code>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">clustermap</span><span class="p">(</span><span class="n">df_wide</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;crest&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x700 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/4400eff230fd603a12d0992707684ad4a6d1fbe6d6fa2058168b9e4bf71289a1.png" src="../_images/4400eff230fd603a12d0992707684ad4a6d1fbe6d6fa2058168b9e4bf71289a1.png" />
</div>
</div>
<p>However, to be on the safe side, please also check your <code class="docutils literal notranslate"><span class="pre">graphics</span></code> for the mentioned points, e.g. via tools like <a class="reference external" href="https://colororacle.org/">Color Oracle</a> that let you simulate <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">vision</span> <span class="pre">deficiencies</span></code>!</p>
<center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_5.png" width="800px" style="margin-bottom: 10px;"></center><p>Make use of amazing resources like the <a class="reference external" href="https://www.python-graph-gallery.com/">python graph gallery</a>, the <a class="reference external" href="https://www.data-to-viz.com/">data to viz project</a> and the <a class="reference external" href="https://www.nature.com/articles/s41467-020-19160-7">colormap decision tree in Crameri et al. 2020</a>, that in combination allow you to find and use the best <code class="docutils literal notranslate"><span class="pre">graphic</span></code> and <code class="docutils literal notranslate"><span class="pre">colormap</span></code> for your data!</p>
<p>And NEVER USE JET!</p>
<center><img src="https://raw.githubusercontent.com/PeerHerholz/Python_for_Psychologists_Winter2021/master/lecture/static/colormaps_6.png" width="500px" style="margin-bottom: 10px;"></center><p>There appear to be some interesting effects we should investigate further which leads us to the <code class="docutils literal notranslate"><span class="pre">grand</span> <span class="pre">finale</span></code>: <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">analyses</span></code> using <code class="docutils literal notranslate"><span class="pre">python</span></code>!</p>
<p>But before it one final test. We need to finally make meaningful plots!</p>
<ul class="simple">
<li><p>First, create a new column which will have the words ‘congruent’ and ‘incongruent’ in corresponding rows</p></li>
<li><p>Use the plot of your choice to find whether there are any differences in RT and correct answers between congruent and incongruent trials</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#work here</span>
</pre></div>
</div>
</div>
</div>
<p>Now try to find if there is any relation between RT and trial number! Find a suitable plot for it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="statistics-in-python">
<h2>Statistics in python<a class="headerlink" href="#statistics-in-python" title="Link to this heading">#</a></h2>
<p>We’ve reached the final step of our <code class="docutils literal notranslate"><span class="pre">analyses</span> <span class="pre">workflow</span></code>: <code class="docutils literal notranslate"><span class="pre">statistics</span></code>, i.e. putting things to test via evaluating <code class="docutils literal notranslate"><span class="pre">hypotheses</span></code> and/or <code class="docutils literal notranslate"><span class="pre">assumptions</span></code>! As with the previous aspects, <code class="docutils literal notranslate"><span class="pre">python</span></code> has a lot of <code class="docutils literal notranslate"><span class="pre">libraries</span></code> and <code class="docutils literal notranslate"><span class="pre">modules</span></code> for this purpose, some general-domain and some rather tailored to specific data and analyzes (e.g. <code class="docutils literal notranslate"><span class="pre">fMRI</span></code>, <code class="docutils literal notranslate"><span class="pre">EEG</span></code>, <code class="docutils literal notranslate"><span class="pre">drift</span> <span class="pre">diffusion</span> <span class="pre">models</span></code>, etc.).</p>
<p>Here, we will stick with the general-domain ones as they are already support a huge amount of approaches and are commonly used by the community: <a class="reference internal" href="#"><span class="xref myst">pingouin</span></a> and <a class="reference internal" href="#"><span class="xref myst">statsmodels</span></a>. As before, we will go through several steps and explore respective <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">modules</span></code> and <code class="docutils literal notranslate"><span class="pre">functions</span></code>.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#"><span class="xref myst">Statistics in python</span></a></p>
<ul>
<li><p><a class="reference internal" href="#"><span class="xref myst">Descriptive analyses</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="xref myst">Inferential analyses</span></a></p></li>
</ul>
</li>
</ul>
<section id="descriptive-analyses">
<h3>Descriptive analyses<a class="headerlink" href="#descriptive-analyses" title="Link to this heading">#</a></h3>
<p>Regarding the first aspect, <code class="docutils literal notranslate"><span class="pre">descriptive</span> <span class="pre">analyses</span></code>, we can safely state that we already know how to do this. For example using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and their respective <code class="docutils literal notranslate"><span class="pre">functions</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.73307 0.5862532456143087
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.73307 0.5852753412710977
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_long</span><span class="p">[[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="s1">&#39;resp.corr&#39;</span><span class="p">,</span><span class="s1">&#39;congruent&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;congruent&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary statistics for: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">idx</span>)
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summary statistics for: 0.0
          resp.rt   resp.corr  congruent
count  150.000000  150.000000      150.0
mean     0.780460    0.893333        0.0
std      0.735391    0.309723        0.0
min      0.320000    0.000000        0.0
25%      0.514250    1.000000        0.0
50%      0.629000    1.000000        0.0
75%      0.838250    1.000000        0.0
max      8.553000    1.000000        0.0
Summary statistics for: 1.0
          resp.rt   resp.corr  congruent
count  150.000000  150.000000      150.0
mean     0.685680    0.920000        1.0
std      0.379962    0.272202        0.0
min      0.299000    0.000000        1.0
25%      0.509000    1.000000        1.0
50%      0.598500    1.000000        1.0
75%      0.750000    1.000000        1.0
max      3.564000    1.000000        1.0
</pre></div>
</div>
</div>
</div>
<p>Thus, we can skip these aspects here and directly move on! Regarding <code class="docutils literal notranslate"><span class="pre">inferential</span> <span class="pre">analyses</span></code>, we will start with and focus on <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>!</p>
<p>Unfortunately not those…</p>
<center><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Penguin_in_Antarctica_jumping_out_of_the_water.jpg/800px-Penguin_in_Antarctica_jumping_out_of_the_water.jpg" width="300px" style="margin-bottom: 10px;"></center>
<p>but make sure to check <a class="reference external" href="https://www.penguinsinternational.org/">https://www.penguinsinternational.org/</a> to see what you can do to help our amazing friends: the <code class="docutils literal notranslate"><span class="pre">Penguin</span></code>s!</p>
</section>
<section id="inferential-analyses">
<h3>Inferential analyses<a class="headerlink" href="#inferential-analyses" title="Link to this heading">#</a></h3>
<p>Of course, <code class="docutils literal notranslate"><span class="pre">exploring</span></code> and <code class="docutils literal notranslate"><span class="pre">visualizing</span> <span class="pre">data</span></code> is informative and can hint at certain effects but we nevertheless have to run <code class="docutils literal notranslate"><span class="pre">test</span></code>s and obtain respective <code class="docutils literal notranslate"><span class="pre">statistics</span></code> to evaluate if there’s “something meaningful”. This is where <code class="docutils literal notranslate"><span class="pre">inferential</span> <span class="pre">analyses</span></code> come into play!</p>
</section>
<section id="pingouin">
<h3><a class="reference external" href="https://pingouin-stats.org/">Pingouin</a><a class="headerlink" href="#pingouin" title="Link to this heading">#</a></h3>
<center><img src="https://pingouin-stats.org/build/html/_images/logo_pingouin.png" width="400px" style="margin-bottom: 10px;"></center>
<p>Even though comparably new, <code class="docutils literal notranslate"><span class="pre">Pingouin</span></code> quickly became a staple regarding <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">analyses</span></code> as it integrates amazingly well with the existing <code class="docutils literal notranslate"><span class="pre">python</span></code> <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">science</span></code> stack, e.g. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. As mentioned in the <code class="docutils literal notranslate"><span class="pre">docs</span></code>: “<code class="docutils literal notranslate"><span class="pre">Pingouin</span></code> is designed for users who want simple yet exhaustive <code class="docutils literal notranslate"><span class="pre">stats</span></code> functions.”, which summarizes it perfectly as it supports the majority of commonly used <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">functions</span></code> and additionally provides adjacent functionality, e.g. related to <code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">diagnostics</span></code> and <code class="docutils literal notranslate"><span class="pre">evaluation</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ANOVAs</span></code>: <code class="docutils literal notranslate"><span class="pre">N-ways</span></code>, <code class="docutils literal notranslate"><span class="pre">repeated</span> <span class="pre">measures</span></code>, <code class="docutils literal notranslate"><span class="pre">mixed</span></code>, <code class="docutils literal notranslate"><span class="pre">ancova</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pairwise</span> <span class="pre">post-hocs</span> <span class="pre">tests</span></code> (<code class="docutils literal notranslate"><span class="pre">parametric</span></code> and <code class="docutils literal notranslate"><span class="pre">non-parametric</span></code>) and <code class="docutils literal notranslate"><span class="pre">pairwise</span> <span class="pre">correlations</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">robust</span></code>, <code class="docutils literal notranslate"><span class="pre">partial</span></code>, <code class="docutils literal notranslate"><span class="pre">distance</span></code> and <code class="docutils literal notranslate"><span class="pre">repeated</span> <span class="pre">measures</span> <span class="pre">correlations</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code>/<code class="docutils literal notranslate"><span class="pre">logistic</span></code> <code class="docutils literal notranslate"><span class="pre">regression</span></code> and <code class="docutils literal notranslate"><span class="pre">mediation</span> <span class="pre">analysis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Bayes</span> <span class="pre">Factors</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multivariate</span> <span class="pre">tests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reliability</span></code> and <code class="docutils literal notranslate"><span class="pre">consistency</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">effect</span> <span class="pre">sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">power</span> <span class="pre">analysis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parametric</span></code>/<code class="docutils literal notranslate"><span class="pre">bootstrapped</span></code> <code class="docutils literal notranslate"><span class="pre">confidence</span> <span class="pre">intervals</span></code> around an <code class="docutils literal notranslate"><span class="pre">effect</span> <span class="pre">size</span></code> or a <code class="docutils literal notranslate"><span class="pre">correlation</span> <span class="pre">coefficient</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">circular</span> <span class="pre">statistics</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chi-squared</span> <span class="pre">tests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plotting</span></code>: <code class="docutils literal notranslate"><span class="pre">Bland-Altman</span> <span class="pre">plot</span></code>, <code class="docutils literal notranslate"><span class="pre">Q-Q</span> <span class="pre">plot</span></code>, <code class="docutils literal notranslate"><span class="pre">paired</span> <span class="pre">plot</span></code>, <code class="docutils literal notranslate"><span class="pre">robust</span> <span class="pre">correlation</span></code>…</p></li>
</ul>
<p>When in doubt, make sure to check if <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> has your back!</p>
<p>One of the first things we explored via the previous <code class="docutils literal notranslate"><span class="pre">analyses</span> <span class="pre">steps</span></code> was if the <code class="docutils literal notranslate"><span class="pre">ratings</span></code> vary as a function of <code class="docutils literal notranslate"><span class="pre">age</span></code>. While the <code class="docutils literal notranslate"><span class="pre">plots</span></code> suggested at some potential effects, we can simply compute their <code class="docutils literal notranslate"><span class="pre">correlation</span></code> using <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>’s <a class="reference internal" href="#"><span class="xref myst">corr</span></a> <code class="docutils literal notranslate"><span class="pre">function</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">frameRate_list</span><span class="p">,</span> <span class="n">rt_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>p-val</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pearson</th>
      <td>10</td>
      <td>-0.41001</td>
      <td>[-0.83, 0.3]</td>
      <td>0.239279</td>
      <td>0.717</td>
      <td>0.225217</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Not only do we get the <code class="docutils literal notranslate"><span class="pre">correlation</span> <span class="pre">value</span></code> and <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">value</span></code> but also the <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">observations</span></code>, the <code class="docutils literal notranslate"><span class="pre">95%</span> <span class="pre">CI</span></code>, <code class="docutils literal notranslate"><span class="pre">Bayes</span> <span class="pre">Factor</span></code> and the <code class="docutils literal notranslate"><span class="pre">power</span></code>. Pretty convenient, eh?</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">heatmap</span></code> and <code class="docutils literal notranslate"><span class="pre">clustermap</span></code>s we also evaluate the <code class="docutils literal notranslate"><span class="pre">correlation</span> <span class="pre">pattern</span></code> of <code class="docutils literal notranslate"><span class="pre">different</span> <span class="pre">conditions</span></code>. In order to put some more numbers on that, we can make use of the mentioned <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> - <code class="docutils literal notranslate"><span class="pre">pandas</span></code> friendship and compute multiple <code class="docutils literal notranslate"><span class="pre">pairwise</span> <span class="pre">correlations</span></code> based on the <code class="docutils literal notranslate"><span class="pre">columns</span></code> of a <code class="docutils literal notranslate"><span class="pre">dataframe</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cor</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">pairwise_corr</span><span class="p">(</span><span class="n">df_wide</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
<span class="n">df_cor</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>method</th>
      <th>alternative</th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>p-unc</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent0.0_textgreen_colorblue</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.812087</td>
      <td>[0.37, 0.95]</td>
      <td>0.004319</td>
      <td>13.317</td>
      <td>0.874392</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent0.0_textred_colorgreen</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.959666</td>
      <td>[0.83, 0.99]</td>
      <td>0.000011</td>
      <td>1284.587</td>
      <td>0.999531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textblue_colorblue</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.961608</td>
      <td>[0.84, 0.99]</td>
      <td>0.000009</td>
      <td>1490.035</td>
      <td>0.999631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textgreen_colorgreen</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.887717</td>
      <td>[0.59, 0.97]</td>
      <td>0.000606</td>
      <td>60.022</td>
      <td>0.970876</td>
    </tr>
    <tr>
      <th>4</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textred_colorred</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.965283</td>
      <td>[0.86, 0.99]</td>
      <td>0.000006</td>
      <td>2016.543</td>
      <td>0.999777</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We get a <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> in return, which we can then use for further analyses. For example, as we did run quite a few tests, we might want to <code class="docutils literal notranslate"><span class="pre">correct</span></code> our <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">values</span></code> for <code class="docutils literal notranslate"><span class="pre">multiple</span> <span class="pre">comparisons</span></code>. Obviously, <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> also makes this super easy via it’s <a class="reference external" href="https://pingouin-stats.org/generated/pingouin.multicomp.html#pingouin.multicomp">multicomp</a> <code class="docutils literal notranslate"><span class="pre">function</span></code> which returns an <code class="docutils literal notranslate"><span class="pre">list</span></code> with <code class="docutils literal notranslate"><span class="pre">True/False</span></code> <code class="docutils literal notranslate"><span class="pre">booleans</span></code> and <code class="docutils literal notranslate"><span class="pre">corrected</span> <span class="pre">p</span> <span class="pre">values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cor</span><span class="p">[</span><span class="s1">&#39;p_corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">multicomp</span><span class="p">(</span><span class="n">df_cor</span><span class="p">[</span><span class="s1">&#39;p-unc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bonf&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df_cor</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>method</th>
      <th>alternative</th>
      <th>n</th>
      <th>r</th>
      <th>CI95%</th>
      <th>p-unc</th>
      <th>BF10</th>
      <th>power</th>
      <th>p_corr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent0.0_textgreen_colorblue</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.812087</td>
      <td>[0.37, 0.95]</td>
      <td>0.004319</td>
      <td>13.317</td>
      <td>0.874392</td>
      <td>0.064781</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent0.0_textred_colorgreen</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.959666</td>
      <td>[0.83, 0.99]</td>
      <td>0.000011</td>
      <td>1284.587</td>
      <td>0.999531</td>
      <td>0.000165</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textblue_colorblue</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.961608</td>
      <td>[0.84, 0.99]</td>
      <td>0.000009</td>
      <td>1490.035</td>
      <td>0.999631</td>
      <td>0.000136</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textgreen_colorgreen</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.887717</td>
      <td>[0.59, 0.97]</td>
      <td>0.000606</td>
      <td>60.022</td>
      <td>0.970876</td>
      <td>0.009090</td>
    </tr>
    <tr>
      <th>4</th>
      <td>rt_congruent0.0_textblue_colorred</td>
      <td>rt_congruent1.0_textred_colorred</td>
      <td>pearson</td>
      <td>two-sided</td>
      <td>10</td>
      <td>0.965283</td>
      <td>[0.86, 0.99]</td>
      <td>0.000006</td>
      <td>2016.543</td>
      <td>0.999777</td>
      <td>0.000091</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now please compute something more “meaningful” like correlation between frame rate, reaction time and trial number</p>
<ul class="simple">
<li><p>adjust p value using holm method</p></li>
<li><p>add column which shows True if p value is significant and False if not</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># work here</span>
</pre></div>
</div>
</div>
</div>
<p>We can reformulate our <code class="docutils literal notranslate"><span class="pre">analyses</span></code> to an <code class="docutils literal notranslate"><span class="pre">regression</span> <span class="pre">problem</span></code> and thus run a <code class="docutils literal notranslate"><span class="pre">multiple</span> <span class="pre">regression</span></code> via <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>’s   <a class="reference internal" href="#"><span class="xref myst">linear_regression</span></a> <code class="docutils literal notranslate"><span class="pre">function</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_reg</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">linear_regression</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">],</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;trial_number&#39;</span><span class="p">])</span>
<span class="n">movie_reg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>coef</th>
      <th>se</th>
      <th>T</th>
      <th>pval</th>
      <th>r2</th>
      <th>adj_r2</th>
      <th>CI[2.5%]</th>
      <th>CI[97.5%]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Intercept</td>
      <td>16.499060</td>
      <td>0.800194</td>
      <td>20.618833</td>
      <td>2.589562e-59</td>
      <td>0.008492</td>
      <td>0.005165</td>
      <td>14.924313</td>
      <td>18.073806</td>
    </tr>
    <tr>
      <th>1</th>
      <td>resp.rt</td>
      <td>-1.362844</td>
      <td>0.853039</td>
      <td>-1.597634</td>
      <td>1.111843e-01</td>
      <td>0.008492</td>
      <td>0.005165</td>
      <td>-3.041587</td>
      <td>0.315900</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Which would again provide a very exhaustive and intelligible output that can easily be utilized further.</p>
<p>One of the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> of the <code class="docutils literal notranslate"><span class="pre">regression</span></code> reminds us of “a very low hanging fruit” we haven’t checked yet: <code class="docutils literal notranslate"><span class="pre">T-Test</span></code>s! Lets finally test the usual Stroop hypothesis!</p>
<p>That’s right: <code class="docutils literal notranslate"><span class="pre">testing</span> <span class="pre">statistical</span> <span class="pre">premises</span></code>/<code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">assumptions</span></code>! In other words: we need to evaluate if the assumptions/requirements for a <code class="docutils literal notranslate"><span class="pre">parametric</span> <span class="pre">test</span></code>, like the <code class="docutils literal notranslate"><span class="pre">T-Test</span></code> are fulfilled or if we need to apply a <code class="docutils literal notranslate"><span class="pre">non-parametric</span> <span class="pre">test</span></code>.</p>
<p>At first, we are going to test the <code class="docutils literal notranslate"><span class="pre">distribution</span></code> of our <code class="docutils literal notranslate"><span class="pre">data</span></code>. Often folks assume that their data follows a <code class="docutils literal notranslate"><span class="pre">gaussian</span> <span class="pre">distribution</span></code>, which allows for <code class="docutils literal notranslate"><span class="pre">parametric</span> <span class="pre">tests</span></code> to be run. Nevertheless it is essential to first <code class="docutils literal notranslate"><span class="pre">test</span></code> the <code class="docutils literal notranslate"><span class="pre">distribution</span></code> of your <code class="docutils literal notranslate"><span class="pre">data</span></code> to decide if the <code class="docutils literal notranslate"><span class="pre">assumption</span></code> of <code class="docutils literal notranslate"><span class="pre">normally</span> <span class="pre">distributed</span> <span class="pre">data</span></code> holds, if this is not the case we would have to switch to <code class="docutils literal notranslate"><span class="pre">non-parametric</span> <span class="pre">tests</span></code>.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> this is again only one brief function away. Here specifically, the <a class="reference external" href="https://pingouin-stats.org/generated/pingouin.normality.html#pingouin.normality">normality()</a> <code class="docutils literal notranslate"><span class="pre">function</span></code> that implements the <a class="reference external" href="https://pingouin-stats.org/generated/pingouin.normality.html#pingouin.normality">Shapiro Wilk normality test</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">normality</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>pval</th>
      <th>normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>resp.rt</th>
      <td>0.418217</td>
      <td>5.602158e-30</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#now check the same for correct reports!</span>
</pre></div>
</div>
</div>
</div>
<p>Not, so good, but for learning purposes lets continue with T-test.</p>
<p>By now you might know that <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> obviously has a dedicated <code class="docutils literal notranslate"><span class="pre">function</span></code> for this and of course you’re right: <a class="reference external" href="https://pingouin-stats.org/generated/pingouin.ttest.html#pingouin.ttest">ttest</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;congruent&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">],</span> <span class="n">df_long</span><span class="p">[</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;congruent&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">],</span> <span class="n">paired</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-1.629319</td>
      <td>149</td>
      <td>two-sided</td>
      <td>0.105358</td>
      <td>[-0.21, 0.02]</td>
      <td>0.161932</td>
      <td>0.331</td>
      <td>0.50423</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since we are working with paired t-test, there is a dedicated function which makes everything easier!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span>
    <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span>
    <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">within</span><span class="o">=</span><span class="s1">&#39;congruent&#39;</span><span class="p">,</span>
    <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>congruent</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>True</td>
      <td>True</td>
      <td>1.774183</td>
      <td>9.0</td>
      <td>two-sided</td>
      <td>0.10978</td>
      <td>0.987</td>
      <td>0.275808</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But we have different results? Why? Which one is correct?</p>
<p>We can actually make another version correct as well</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Align data by participant (only participants with both conditions)</span>
<span class="n">df_paired</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;congruent&#39;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Perform the paired t-test</span>
<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_paired</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
    <span class="n">y</span><span class="o">=</span><span class="n">df_paired</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
    <span class="n">paired</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-1.774183</td>
      <td>9</td>
      <td>two-sided</td>
      <td>0.10978</td>
      <td>[-0.22, 0.03]</td>
      <td>0.287976</td>
      <td>0.987</td>
      <td>0.129216</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we however wanted to run a <code class="docutils literal notranslate"><span class="pre">non-parametric</span> <span class="pre">test</span></code>, here a <a class="reference external" href="https://pingouin-stats.org/generated/pingouin.wilcoxon.html#pingouin.wilcoxon">wilcoxon test</a>, we can do so without problems:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_paired</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df_paired</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W-val</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>RBC</th>
      <th>CLES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Wilcoxon</th>
      <td>10.0</td>
      <td>two-sided</td>
      <td>0.083984</td>
      <td>-0.636364</td>
      <td>0.43</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now check whats going on with correct reports!</span>
</pre></div>
</div>
</div>
</div>
<p>While we could now go through each comparison of interest, we might want to approach the <code class="docutils literal notranslate"><span class="pre">analyses</span></code> from a different angle. For example, starting with an <code class="docutils literal notranslate"><span class="pre">anova</span></code> comparing ratings between <code class="docutils literal notranslate"><span class="pre">text</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">rm_anova</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">within</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span> <span class="n">detailed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>SS</th>
      <th>DF</th>
      <th>MS</th>
      <th>F</th>
      <th>p-unc</th>
      <th>p-GG-corr</th>
      <th>ng2</th>
      <th>eps</th>
      <th>sphericity</th>
      <th>W-spher</th>
      <th>p-spher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>text</td>
      <td>0.010958</td>
      <td>2</td>
      <td>0.005479</td>
      <td>0.241367</td>
      <td>0.788055</td>
      <td>0.664249</td>
      <td>0.003477</td>
      <td>0.569127</td>
      <td>False</td>
      <td>0.242924</td>
      <td>0.003482</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Error</td>
      <td>0.408595</td>
      <td>18</td>
      <td>0.022700</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Usually the next step would be to run <code class="docutils literal notranslate"><span class="pre">post-hoc</span> <span class="pre">test</span></code>s contrasting each pair of <code class="docutils literal notranslate"><span class="pre">categories</span></code>. Once more <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> comes to the rescue and implements this in just one <code class="docutils literal notranslate"><span class="pre">function</span></code> within which we can additionally define if we want to run a <code class="docutils literal notranslate"><span class="pre">parametric</span> <span class="pre">test</span></code>, if <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">values</span></code> should be adjusted and what kind of <code class="docutils literal notranslate"><span class="pre">effect</span> <span class="pre">size</span></code> we would like to have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pg</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_long</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">,</span> <span class="n">within</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span>
                             <span class="n">parametric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">padjust</span><span class="o">=</span><span class="s1">&#39;bonf&#39;</span><span class="p">,</span> <span class="n">effsize</span><span class="o">=</span><span class="s1">&#39;cohen&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>p-corr</th>
      <th>p-adjust</th>
      <th>BF10</th>
      <th>cohen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>text</td>
      <td>blue</td>
      <td>green</td>
      <td>True</td>
      <td>True</td>
      <td>0.621562</td>
      <td>9.0</td>
      <td>two-sided</td>
      <td>0.549648</td>
      <td>1.0</td>
      <td>bonf</td>
      <td>0.364</td>
      <td>0.114903</td>
    </tr>
    <tr>
      <th>1</th>
      <td>text</td>
      <td>blue</td>
      <td>red</td>
      <td>True</td>
      <td>True</td>
      <td>-0.295968</td>
      <td>9.0</td>
      <td>two-sided</td>
      <td>0.773970</td>
      <td>1.0</td>
      <td>bonf</td>
      <td>0.321</td>
      <td>-0.039105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>text</td>
      <td>green</td>
      <td>red</td>
      <td>True</td>
      <td>True</td>
      <td>-0.499229</td>
      <td>9.0</td>
      <td>two-sided</td>
      <td>0.629593</td>
      <td>1.0</td>
      <td>bonf</td>
      <td>0.343</td>
      <td>-0.131297</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Isn’t <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> just fantastic? Especially considering that the many things we explored only cover a small percentage of available functionality as we didn’t even look at e.g. <code class="docutils literal notranslate"><span class="pre">mediation</span> <span class="pre">analyses</span></code>, <code class="docutils literal notranslate"><span class="pre">contingency</span> <span class="pre">analyses</span></code>, <code class="docutils literal notranslate"><span class="pre">multivariate</span> <span class="pre">tests</span></code>, <code class="docutils literal notranslate"><span class="pre">reliability</span></code>, etc. . However, you should have got an idea how powerful and versatile <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> is for the majority of analyses you commonly run.</p>
<p>NB 1: A small note before we continue: a lot of these “<code class="docutils literal notranslate"><span class="pre">standard</span> <span class="pre">analyses</span></code>” and more are also implemented in the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html">scipy.stats</a> <code class="docutils literal notranslate"><span class="pre">module</span></code> which is might be interesting if there’s something you want to run that is implemented <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>.</p>
<p>NB 2: we focused on <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> because of it’s large amount of functions, great integration with <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and high-level <code class="docutils literal notranslate"><span class="pre">API</span></code>.</p>
<p>Even though it’s a <code class="docutils literal notranslate"><span class="pre">virtual</span> <span class="pre">class</span></code> I can literally hear folks yell: “What about formulas? I need to define formulas!”.</p>
<p>Don’t you worry a thing: while this is (yet) not possible in <code class="docutils literal notranslate"><span class="pre">pingouin</span></code>, there’s of course a different <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">module</span></code> that can do these things. Open your hearts for <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>!</p>
</section>
<section id="statsmodels">
<h3><a class="reference external" href="https://www.statsmodels.org/stable/index.html">Statsmodels</a><a class="headerlink" href="#statsmodels" title="Link to this heading">#</a></h3>
<center><img src="https://www.statsmodels.org/stable/_images/statsmodels-logo-v2-horizontal.svg" width="400px" style="margin-bottom: 10px;"></center>
<p><code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> (sorry no animal pun, don’t know why) is yet another great <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">module</span></code> for <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">analyses</span></code>. In contrast to <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> it focuses on rather complex and more specialized <code class="docutils literal notranslate"><span class="pre">analyses</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regression</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">discrete</span> <span class="pre">choice</span> <span class="pre">models</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Generalized</span> <span class="pre">Estimating</span> <span class="pre">Equations</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meta-analyses</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time-series</span></code>, <code class="docutils literal notranslate"><span class="pre">forecasting</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span> <span class="pre">space</span> <span class="pre">models</span></code></p></li>
<li><p>etc.</p></li>
</ul>
<p>In order to provide a brief glimpse of how <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> can be used to define and apply <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">models</span></code> via <code class="docutils literal notranslate"><span class="pre">formulas</span></code>, we will check two examples and while doing so ignoring the reasonableness. At first we will import the <code class="docutils literal notranslate"><span class="pre">formula.api</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
</pre></div>
</div>
</div>
</div>
<p>Which can then be used to define and run <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">models</span></code>. Independent of the specific <code class="docutils literal notranslate"><span class="pre">model</span></code> the outline is roughly identical: a <code class="docutils literal notranslate"><span class="pre">model</span></code> is defined via a <code class="docutils literal notranslate"><span class="pre">string</span></code> e.g. referencing the <code class="docutils literal notranslate"><span class="pre">columns</span></code>/<code class="docutils literal notranslate"><span class="pre">variables</span></code> of a <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> and then <code class="docutils literal notranslate"><span class="pre">fit</span></code>ted. Subsequently, all aspects of the <code class="docutils literal notranslate"><span class="pre">model</span></code> can be accessed. For example, a simple <code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">regression</span></code> via an <code class="docutils literal notranslate"><span class="pre">ordinary</span> <span class="pre">least</span> <span class="pre">squares</span></code> would look like the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;rt&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;resp.rt&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;rt ~ trial_number&quot;</span><span class="p">,</span> <span class="n">df_long</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> <code class="docutils literal notranslate"><span class="pre">function</span></code> we can then get a holistic overview of the <code class="docutils literal notranslate"><span class="pre">model</span></code> and the outcomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                     rt   R-squared:                       0.008
Model:                            OLS   Adj. R-squared:                  0.005
Method:                 Least Squares   F-statistic:                     2.552
Date:                Thu, 13 Feb 2025   Prob (F-statistic):              0.111
Time:                        14:57:12   Log-Likelihood:                -263.70
No. Observations:                 300   AIC:                             531.4
Df Residuals:                     298   BIC:                             538.8
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept        0.8297      0.069     11.982      0.000       0.693       0.966
trial_number    -0.0062      0.004     -1.598      0.111      -0.014       0.001
==============================================================================
Omnibus:                      488.908   Durbin-Watson:                   1.486
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           136970.679
Skew:                           8.591   Prob(JB):                         0.00
Kurtosis:                     106.259   Cond. No.                         36.5
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>All displayed information is furthermore directly accessible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">bic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>538.8083391527322
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">fvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.552433103431772
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">resid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     -0.188426
1     -0.475194
2     -0.169963
3      0.271268
4     -0.118500
         ...   
295    0.047360
296   -0.173408
297   -0.141177
298   -0.100946
299    0.057286
Length: 300, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#try to extract p value!</span>
</pre></div>
</div>
</div>
</div>
<p>If we also want to define and run a <code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">mixed</span> <span class="pre">effects</span> <span class="pre">model</span></code>, we only need to change the <code class="docutils literal notranslate"><span class="pre">model</span> <span class="pre">type</span></code> to <code class="docutils literal notranslate"><span class="pre">mixedlm</span></code> and define our <code class="docutils literal notranslate"><span class="pre">model</span></code> accordingly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">mixedlm</span><span class="p">(</span><span class="s2">&quot;rt ~ congruent&quot;</span><span class="p">,</span> <span class="n">df_long</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">df_long</span><span class="p">[</span><span class="s2">&quot;participant&quot;</span><span class="p">])</span>
<span class="n">mdf</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mdf</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Mixed Linear Model Regression Results
=======================================================
Model:            MixedLM Dependent Variable: rt       
No. Observations: 300     Method:             REML     
No. Groups:       10      Scale:              0.2587   
Min. group size:  30      Log-Likelihood:     -237.4849
Max. group size:  30      Converged:          Yes      
Mean group size:  30.0                                 
-------------------------------------------------------
             Coef.  Std.Err.   z    P&gt;|z| [0.025 0.975]
-------------------------------------------------------
Intercept     0.780    0.105  7.448 0.000  0.575  0.986
congruent    -0.095    0.059 -1.614 0.107 -0.210  0.020
Group Var     0.093    0.095                           
=======================================================
</pre></div>
</div>
</div>
</div>
<p>Overall, there’s only one thing left to say regarding <code class="docutils literal notranslate"><span class="pre">statistical</span> <span class="pre">analyses</span></code> in <code class="docutils literal notranslate"><span class="pre">python</span></code>:</p>
<center><img src="https://media3.giphy.com/media/4lsPD0wSyJCec/giphy.gif?cid=790b7611f8ee67d5c76fdbea20a43d0c394fdd883924de00&rid=giphy.gif&ct=g" width="400px" style="margin-bottom: 10px;"></center>
</section>
</section>
<section id="outro-q-a-visualization-statistics">
<h2>Outro/Q&amp;A - visualization &amp; statistics<a class="headerlink" href="#outro-q-a-visualization-statistics" title="Link to this heading">#</a></h2>
<p>What we went through in this session was intended as a super small showcase of <code class="docutils literal notranslate"><span class="pre">visualizing</span></code> and <code class="docutils literal notranslate"><span class="pre">analyzing</span></code> <code class="docutils literal notranslate"><span class="pre">data</span></code> via <code class="docutils literal notranslate"><span class="pre">python</span></code>, specifically using a small subset of available <code class="docutils literal notranslate"><span class="pre">modules</span></code> which we only just started to explore and have way more functionality.</p>
<p>Sure: this was a very specific use case and <code class="docutils literal notranslate"><span class="pre">data</span></code> but the steps and underlying principles are transferable to the majority of comparable problems/tasks you might encounter. Especially because the <code class="docutils literal notranslate"><span class="pre">modules</span></code> we checked are commonly used and are usually the “go-to” option, at least as a first step. As always: make sure to check the fantastic docs of the <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">modules</span></code> you’re using, as well as all the fantastic tutorials out there.</p>
</section>
<section id="outro-q-a-working-with-data-in-python">
<h2>Outro/Q&amp;A - working with data in python<a class="headerlink" href="#outro-q-a-working-with-data-in-python" title="Link to this heading">#</a></h2>
<p>As mentioned in the beginning, there are so many options of working with <code class="docutils literal notranslate"><span class="pre">data</span></code> and setting up correspondingly <code class="docutils literal notranslate"><span class="pre">workflows</span></code> that vary as a function of <code class="docutils literal notranslate"><span class="pre">data</span></code> at hand and planned <code class="docutils literal notranslate"><span class="pre">analyses</span></code>. Finding the “only right option” might also not be possible in some cases.</p>
<p>The idea of this section of the course was to outline an example <code class="docutils literal notranslate"><span class="pre">workflow</span></code> based on some “real-world data” to showcase you some of the capabilities and things you can do using <code class="docutils literal notranslate"><span class="pre">python</span></code>. Specifically, once more making the case that <code class="docutils literal notranslate"><span class="pre">python</span></code> has <code class="docutils literal notranslate"><span class="pre">module</span></code>/<code class="docutils literal notranslate"><span class="pre">library</span></code> for basically everything you want to do, which are additionally rather straightforward and easy to use and come with comprehensive documentation, as well as many tutorials. This holds true for both domain-general and highly specialized use cases. From <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">exploration</span></code> over <code class="docutils literal notranslate"><span class="pre">visualization</span></code> to <code class="docutils literal notranslate"><span class="pre">analyses</span></code> you will find a great set of resources that integrates amazingly well with one another and allow you to achieve awesome things in an intelligible and reproducible manner!</p>
<section id="the-core-python-data-science-stack">
<h3>The core Python “data science” stack<a class="headerlink" href="#the-core-python-data-science-stack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The Python ecosystem contains tens of thousands of packages</p></li>
<li><p>Several are very widely used in data science applications:</p>
<ul>
<li><p><a class="reference external" href="http://jupyter.org">Jupyter</a>: interactive notebooks</p></li>
<li><p><a class="reference external" href="http://numpy.org">Numpy</a>: numerical computing in Python</p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/">pandas</a>: data structures for Python</p></li>
<li><p><a class="reference external" href="http://scipy.org">Scipy</a>: scientific Python tools</p></li>
<li><p><a class="reference external" href="http://matplotlib.org">Matplotlib</a>: plotting in Python</p></li>
<li><p><a class="reference external" href="http://scikit-learn.org">scikit-learn</a>: machine learning in Python</p></li>
</ul>
</li>
<li><p>We’ll cover the first three very briefly here</p>
<ul>
<li><p>Other tutorials will go into greater detail on most of the others</p></li>
</ul>
</li>
</ul>
</section>
<section id="the-core-python-for-psychology-stack">
<h3>The core “Python for psychology” stack<a class="headerlink" href="#the-core-python-for-psychology-stack" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">ecosystem</span></code> contains tens of thousands of <code class="docutils literal notranslate"><span class="pre">packages</span></code></p></li>
<li><p>Several are very widely used in psychology research:</p>
<ul>
<li><p><a class="reference external" href="http://jupyter.org">Jupyter</a>: interactive notebooks</p></li>
<li><p><a class="reference external" href="http://numpy.org">Numpy</a>: numerical computing in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/">pandas</a>: data structures for <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="http://scipy.org">Scipy</a>: scientific <code class="docutils literal notranslate"><span class="pre">Python</span></code> tools</p></li>
<li><p><a class="reference external" href="http://matplotlib.org">Matplotlib</a>: plotting in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/index.html">seaborn</a>: plotting in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="http://scikit-learn.org">scikit-learn</a>: machine learning in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a>: statistical analyses in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://pingouin-stats.org/">pingouin</a>: statistical analyses in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://www.psychopy.org/">psychopy</a>: running experiments in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://nilearn.github.io/stable/index.html">nilearn</a>: brain imaging analyses in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
<li><p><a class="reference external" href="https://mne.tools/stable/index.html">mne</a>: electrophysiology analyses in <code class="docutils literal notranslate"><span class="pre">Python</span></code></p></li>
</ul>
</li>
<li><p>Execept <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, <code class="docutils literal notranslate"><span class="pre">nilearn</span></code> and <code class="docutils literal notranslate"><span class="pre">mne</span></code>, we’ll cover all very briefly in this course</p>
<ul>
<li><p>there are many free tutorials online that will go into greater detail and also cover the other <code class="docutils literal notranslate"><span class="pre">packages</span></code></p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./analyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro_data_analyzes_visualization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data analyzes I - basics in data handling</p>
      </div>
    </a>
    <a class="right-next"
       href="../showcases/module_showcases.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python module showcases</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#before-we-get-started">Before we get started …</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives 📍</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-why-do-data-science-in-python">Recap - Why do data science in Python?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#widely-used">Widely-used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-what-kind-of-data-do-i-have-and-where-is-it">Recap - What kind of data do I have and where is it</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-what-is-the-goal-of-the-data-analyzes">Recap - What is the goal of the data analyzes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-how-will-the-respective-steps-be-implemented">Recap - how will the respective steps be implemented</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-data-visualization">Basic data visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underlying-principles">Underlying principles</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">matplotlib</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-plots">standard plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-groupby-in-pandas">📊 Introduction to <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-groupby"><strong>Why Use <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-aggregations-with-groupby"><strong>Common Aggregations with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code></strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-workflow"><strong>GroupBy Workflow:</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-groupby-in-pandas">🐼 <strong>Examples of <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> in Pandas:</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pros">Pros</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cons">Cons</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-interfaces-to-matplotlib">High-level interfaces to matplotlib</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#going-further-with-advanced-plots">Going further with advanced plots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn"><span class="xref myst">Seaborn</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics-in-python">Statistics in python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-analyses">Descriptive analyses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inferential-analyses">Inferential analyses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin">Pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statsmodels">Statsmodels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outro-q-a-visualization-statistics">Outro/Q&amp;A - visualization &amp; statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outro-q-a-working-with-data-in-python">Outro/Q&amp;A - working with data in python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-core-python-data-science-stack">The core Python “data science” stack</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-core-python-for-psychology-stack">The core “Python for psychology” stack</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peer Herholz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>